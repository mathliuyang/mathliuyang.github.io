<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ¸¸æˆä¹‹æ—… - å›¾çµçš„çŒ« X æ™ºæ ¸å­¦æœ¯</title>
    <!-- å¼•å…¥Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- å¼•å…¥GSAPåŠ¨ç”»åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>

    <!-- é…ç½®Tailwindè‡ªå®šä¹‰é¢œè‰²å’Œå­—ä½“ -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0ea5e9', // ä¸»è“è‰²
                        secondary: '#7c3aed', // ç´«è‰²
                        accent: '#ec4899', // ç²‰è‰²å¼ºè°ƒè‰²
                        dark: '#0f172a', // æ·±è‰²èƒŒæ™¯
                        light: '#f8fafc'  // æµ…è‰²æ–‡æœ¬
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 5px rgba(14, 165, 233, 0.5)' },
                            '100%': { boxShadow: '0 0 20px rgba(14, 165, 233, 0.8), 0 0 30px rgba(124, 58, 237, 0.5)' }
                        }
                    }
                }
            }
        }
    </script>

    <!-- è‡ªå®šä¹‰å·¥å…·ç±» -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 0 10px rgba(14, 165, 233, 0.7);
            }
            .bg-grid {
                background-image: linear-gradient(rgba(14, 165, 233, 0.1) 1px, transparent 1px),
                                linear-gradient(90deg, rgba(14, 165, 233, 0.1) 1px, transparent 1px);
                background-size: 20px 20px;
            }
            .perspective-1000 {
                perspective: 1000px;
            }
            .preserve-3d {
                transform-style: preserve-3d;
            }
            .backdrop-blur-md {
                backdrop-filter: blur(12px);
            }
        }
    </style>

    <!-- å…¨å±€æ ·å¼ -->
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            background-color: #0f172a;
            color: #f8fafc;
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1e293b;
        }

        ::-webkit-scrollbar-thumb {
            background: #0ea5e9;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #0284c7;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .equation {
            font-family: 'Times New Roman', serif;
            transition: all 0.3s ease;
        }

        .equation:hover {
            transform: scale(1.03);
            color: #38bdf8;
        }

        /* 3Då¡ç‰‡æ•ˆæœ */
        .card-3d {
            transition: transform 0.5s ease;
        }

        .card-3d:hover {
            transform: translateY(-10px) rotateX(5deg) rotateY(5deg);
        }

        /* æ˜Ÿç©ºèƒŒæ™¯ */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        /* ç²’å­åŠ¨ç”» */
        .particle {
            position: absolute;
            border-radius: 50%;
            background: white;
            opacity: 0.8;
        }
    </style>
</head>

<body class="min-h-screen bg-dark text-light bg-grid">

    <!-- JavaScriptä»£ç  -->
    <script>
        // ç»˜åˆ¶æ¦‚å¿µå›¾1
        function drawConceptGraph1() {
            const canvas = document.getElementById('conceptGraph1');
            if (!canvas) return;

            // è®¾ç½®Canvaså°ºå¯¸
            canvas.width = 280;
            canvas.height = 200;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 1;

            // xè½´
            ctx.beginPath();
            ctx.moveTo(20, height / 2);
            ctx.lineTo(width - 20, height / 2);
            ctx.stroke();

            // yè½´
            ctx.beginPath();
            ctx.moveTo(width / 2, 20);
            ctx.lineTo(width / 2, height - 20);
            ctx.stroke();

            // ç»˜åˆ¶æŠ›ç‰©çº¿ y = xÂ²
            ctx.strokeStyle = '#0ea5e9';
            ctx.lineWidth = 2;
            ctx.beginPath();

            for (let x = -4; x <= 4; x += 0.1) {
                const y = x * x;
                const canvasX = width / 2 + x * 20;
                const canvasY = height / 2 - y * 8;

                if (x === -4) {
                    ctx.moveTo(canvasX, canvasY);
                } else {
                    ctx.lineTo(canvasX, canvasY);
                }
            }
            ctx.stroke();

            // æ·»åŠ å‘å…‰æ•ˆæœ
            ctx.shadowColor = '#0ea5e9';
            ctx.shadowBlur = 10;
            ctx.stroke();
            ctx.shadowBlur = 0;
        }

        // ç»˜åˆ¶æ ¹çš„å¯è§†åŒ–
        function drawRootsVisualization() {
            const canvas = document.getElementById('rootsVisualization');
            if (!canvas) return;

            // è®¾ç½®Canvaså°ºå¯¸
            canvas.width = 280;
            canvas.height = 200;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 1;

            ctx.beginPath();
            ctx.moveTo(20, height / 2);
            ctx.lineTo(width - 20, height / 2);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(width / 2, 20);
            ctx.lineTo(width / 2, height - 20);
            ctx.stroke();

            // ç»˜åˆ¶æ–¹ç¨‹ xÂ² - 4 = 0 çš„å›¾åƒ
            ctx.strokeStyle = '#ec4899';
            ctx.lineWidth = 2;
            ctx.beginPath();

            for (let x = -3; x <= 3; x += 0.1) {
                const y = x * x - 4;
                const canvasX = width / 2 + x * 30;
                const canvasY = height / 2 - y * 10;

                if (x === -3) {
                    ctx.moveTo(canvasX, canvasY);
                } else {
                    ctx.lineTo(canvasX, canvasY);
                }
            }
            ctx.stroke();

            // æ ‡è®°æ ¹ç‚¹
            ctx.fillStyle = '#f59e0b';
            ctx.beginPath();
            ctx.arc(width / 2 - 60, height / 2, 4, 0, 2 * Math.PI); // x = -2
            ctx.fill();

            ctx.beginPath();
            ctx.arc(width / 2 + 60, height / 2, 4, 0, 2 * Math.PI); // x = 2
            ctx.fill();
        }

        // ç»˜åˆ¶å¤ªç©ºèˆ±è®¾è®¡ï¼ˆåŠ¨æ€ç‰ˆæœ¬ï¼‰
        function drawSpacecraftDesignDynamic(cutSize = 5) {
            const canvas = document.getElementById('spacecraftDesign');
            if (!canvas) return;

            // è®¾ç½®Canvaså°ºå¯¸
            canvas.width = 400;
            canvas.height = 300;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶æ˜Ÿç©ºèƒŒæ™¯
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 30; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 1.5;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, 2 * Math.PI);
                ctx.fill();
            }

            // è®¡ç®—å®é™…å°ºå¯¸
            const originalLength = 100;
            const originalWidth = 50;
            const actualLength = originalLength - 2 * cutSize;
            const actualWidth = originalWidth - 2 * cutSize;
            const actualArea = actualLength * actualWidth;

            // ç»˜åˆ¶å¤ªç©ºèˆ±åº•æ¿
            const centerX = width / 2;
            const centerY = height / 2;
            const scale = 2; // ç¼©æ”¾å› å­
            const baseWidth = actualLength * scale;
            const baseHeight = actualWidth * scale;
            const cutSizeScaled = cutSize * scale;

            // ä¸»ä½“åº•æ¿
            ctx.fillStyle = 'rgba(14, 165, 233, 0.3)';
            ctx.strokeStyle = '#0ea5e9';
            ctx.lineWidth = 2;
            ctx.fillRect(centerX - baseWidth / 2, centerY - baseHeight / 2, baseWidth, baseHeight);
            ctx.strokeRect(centerX - baseWidth / 2, centerY - baseHeight / 2, baseWidth, baseHeight);

            // åˆ‡é™¤çš„è§’ï¼ˆæ˜¾ç¤ºä¸ºè™šçº¿ï¼‰
            ctx.strokeStyle = '#ec4899';
            ctx.setLineDash([5, 5]);
            ctx.lineWidth = 1;

            // å››ä¸ªè§’çš„åˆ‡é™¤åŒºåŸŸ
            const corners = [
                { x: centerX - baseWidth / 2 - cutSizeScaled, y: centerY - baseHeight / 2 - cutSizeScaled },
                { x: centerX + baseWidth / 2, y: centerY - baseHeight / 2 - cutSizeScaled },
                { x: centerX - baseWidth / 2 - cutSizeScaled, y: centerY + baseHeight / 2 },
                { x: centerX + baseWidth / 2, y: centerY + baseHeight / 2 }
            ];

            corners.forEach(corner => {
                ctx.strokeRect(corner.x, corner.y, cutSizeScaled, cutSizeScaled);
            });

            ctx.setLineDash([]);

            // æ ‡æ³¨å°ºå¯¸
            ctx.fillStyle = '#f8fafc';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';

            // é•¿åº¦æ ‡æ³¨
            ctx.fillText(`${actualLength.toFixed(1)}m`, centerX, centerY - baseHeight / 2 - 15);
            // å®½åº¦æ ‡æ³¨
            ctx.save();
            ctx.translate(centerX - baseWidth / 2 - 25, centerY);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText(`${actualWidth.toFixed(1)}m`, 0, 0);
            ctx.restore();

            // åˆ‡é™¤è¾¹é•¿æ ‡æ³¨
            ctx.fillStyle = '#ec4899';
            ctx.font = '10px Arial';
            ctx.fillText(`x=${cutSize}`, centerX - baseWidth / 2 - cutSizeScaled / 2, centerY - baseHeight / 2 - cutSizeScaled / 2);

            // é¢ç§¯æ˜¾ç¤º
            ctx.fillStyle = '#f59e0b';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`é¢ç§¯: ${actualArea.toFixed(1)} mÂ²`, centerX, centerY + baseHeight / 2 + 30);

            // ç›®æ ‡é¢ç§¯å¯¹æ¯”
            const targetArea = 3600;
            const diff = Math.abs(actualArea - targetArea);
            ctx.fillStyle = diff < 10 ? '#10b981' : '#ef4444';
            ctx.font = '12px Arial';
            ctx.fillText(`ç›®æ ‡: ${targetArea} mÂ² (å·®å€¼: ${diff.toFixed(1)})`, centerX, centerY + baseHeight / 2 + 50);
        }

        // åˆå§‹åŒ–å¤ªç©ºèˆ±è®¾è®¡æ±‚è§£å™¨
        function initSpacecraftSolver() {
            const cutSizeSlider = document.getElementById('cutSize');
            const cutValueSpan = document.getElementById('cutValue');
            const resultLength = document.getElementById('resultLength');
            const resultWidth = document.getElementById('resultWidth');
            const resultArea = document.getElementById('resultArea');

            if (!cutSizeSlider) return;

            function updateSpacecraft() {
                const cutSize = parseFloat(cutSizeSlider.value);
                const length = 100 - 2 * cutSize;
                const width = 50 - 2 * cutSize;
                const area = length * width;

                // æ›´æ–°æ˜¾ç¤ºå€¼
                cutValueSpan.textContent = cutSize.toFixed(1);
                resultLength.textContent = length.toFixed(1);
                resultWidth.textContent = width.toFixed(1);
                resultArea.textContent = area.toFixed(0);

                // é‡ç»˜å›¾åƒ
                drawSpacecraftDesignDynamic(cutSize);
            }

            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            cutSizeSlider.addEventListener('input', updateSpacecraft);

            // åˆå§‹åŒ–
            updateSpacecraft();
        }

        // ç»˜åˆ¶å¤ªç©ºé›•åƒï¼ˆé»„é‡‘æ¯”ä¾‹ï¼‰
        function drawSpaceStatue() {
            const canvas = document.getElementById('spaceStatue');
            if (!canvas) return;

            // è®¾ç½®Canvaså°ºå¯¸
            canvas.width = 256;
            canvas.height = 384;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶æ˜Ÿç©ºèƒŒæ™¯
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 50; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 2;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, 2 * Math.PI);
                ctx.fill();
            }

            // é»„é‡‘æ¯”ä¾‹è®¡ç®—
            const phi = (1 + Math.sqrt(5)) / 2; // é»„é‡‘æ¯”ä¾‹ â‰ˆ 1.618
            const totalHeight = height * 0.8;
            const baseY = height * 0.9;

            // é›•åƒæ€»é«˜åº¦ä¸º2å…‰å¹´ï¼Œä¸‹éƒ¨ä¸ºxå…‰å¹´ï¼Œä¸Šéƒ¨ä¸º(2-x)å…‰å¹´
            // æ ¹æ®é»„é‡‘æ¯”ä¾‹ï¼šxÂ² = 2(2-x) => xÂ² + 2x - 4 = 0
            // è§£å¾—ï¼šx = -1 + âˆš5 â‰ˆ 1.236
            const x = -1 + Math.sqrt(5);
            const lowerHeight = (x / 2) * totalHeight;
            const upperHeight = ((2 - x) / 2) * totalHeight;

            // ç»˜åˆ¶é›•åƒåº•åº§
            const baseWidth = width * 0.6;
            const baseHeight = 20;
            ctx.fillStyle = '#475569';
            ctx.fillRect((width - baseWidth) / 2, baseY, baseWidth, baseHeight);

            // ç»˜åˆ¶é›•åƒä¸‹éƒ¨ï¼ˆè“è‰²ï¼‰
            const lowerWidth = width * 0.4;
            ctx.fillStyle = '#0ea5e9';
            ctx.fillRect((width - lowerWidth) / 2, baseY - lowerHeight, lowerWidth, lowerHeight);

            // ç»˜åˆ¶é›•åƒä¸Šéƒ¨ï¼ˆç²‰è‰²ï¼‰
            const upperWidth = width * 0.3;
            ctx.fillStyle = '#ec4899';
            ctx.fillRect((width - upperWidth) / 2, baseY - lowerHeight - upperHeight, upperWidth, upperHeight);

            // æ·»åŠ å‘å…‰æ•ˆæœ
            ctx.shadowColor = '#0ea5e9';
            ctx.shadowBlur = 15;
            ctx.fillStyle = '#0ea5e9';
            ctx.fillRect((width - lowerWidth) / 2, baseY - lowerHeight, lowerWidth, lowerHeight);

            ctx.shadowColor = '#ec4899';
            ctx.shadowBlur = 15;
            ctx.fillStyle = '#ec4899';
            ctx.fillRect((width - upperWidth) / 2, baseY - lowerHeight - upperHeight, upperWidth, upperHeight);

            ctx.shadowBlur = 0;

            // ç»˜åˆ¶åˆ†å‰²çº¿
            ctx.strokeStyle = '#f59e0b';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo((width - lowerWidth) / 2, baseY - lowerHeight);
            ctx.lineTo((width - lowerWidth) / 2 + lowerWidth, baseY - lowerHeight);
            ctx.stroke();
            ctx.setLineDash([]);

            // æ·»åŠ æ ‡æ³¨
            ctx.fillStyle = '#f8fafc';
            ctx.font = '14px Arial';
            ctx.textAlign = 'center';

            // æ ‡æ³¨é«˜åº¦
            ctx.fillText('2-x â‰ˆ 0.764', width / 2, baseY - lowerHeight - upperHeight / 2);
            ctx.fillText('x â‰ˆ 1.236', width / 2, baseY - lowerHeight / 2);
            ctx.fillText('é»„é‡‘æ¯”ä¾‹é›•åƒ', width / 2, 30);

            // ç»˜åˆ¶æ–¹ç¨‹
            ctx.font = '12px Arial';
            ctx.fillText('xÂ² = 2(2-x)', width / 2, height - 30);
        }

        // ç»˜åˆ¶ä¸»å‡½æ•°å›¾åƒ
        function drawMainFunctionGraph() {
            const canvas = document.getElementById('mainFunctionGraph');
            if (!canvas) return;
            canvas.width = 600;
            canvas.height = 400;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶ç½‘æ ¼
            ctx.strokeStyle = 'rgba(71, 85, 105, 0.3)';
            ctx.lineWidth = 0.5;

            const gridSize = 20;
            for (let x = 0; x <= width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }

            for (let y = 0; y <= height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;

            const centerX = width / 2;
            const centerY = height / 2;

            // xè½´
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.stroke();

            // yè½´
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();

            // ç»˜åˆ¶æŠ›ç‰©çº¿ y = xÂ²
            ctx.strokeStyle = '#0ea5e9';
            ctx.lineWidth = 3;
            ctx.beginPath();

            let firstPoint = true;
            for (let x = -10; x <= 10; x += 0.1) {
                const y = x * x;
                const canvasX = centerX + x * 20;
                const canvasY = centerY - y * 10;

                if (canvasY >= 0 && canvasY <= height) {
                    if (firstPoint) {
                        ctx.moveTo(canvasX, canvasY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(canvasX, canvasY);
                    }
                }
            }
            ctx.stroke();

            // æ·»åŠ å‘å…‰æ•ˆæœ
            ctx.shadowColor = '#0ea5e9';
            ctx.shadowBlur = 10;
            ctx.stroke();
            ctx.shadowBlur = 0;
        }
    </script>
    <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
    <div class="stars" id="stars"></div>

    <!-- å¤´éƒ¨å¯¼èˆª -->
    <header class="fixed w-full top-0 z-50 backdrop-blur-md bg-dark/80 border-b border-primary/20">
        <!-- è¯¾ä»¶ä¿¡æ¯æ  -->
        <div class="bg-gradient-to-r from-primary/10 to-secondary/10 border-b border-primary/30">
            <div class="container mx-auto px-4 py-2">
                <div class="flex flex-col md:flex-row justify-between items-center text-sm">
                    <div class="flex items-center space-x-4 mb-2 md:mb-0">
                        <span class="text-primary font-semibold">ğŸ« å››å·å¤§å­¦</span>
                        <span class="text-secondary">ğŸ“š è®¡ç®—æœºå­¦é™¢</span>
                        <span class="text-accent">ğŸ‘¨â€ğŸ« ä½œè€…ï¼šå›¾çµçš„çŒ« X æ™ºæ ¸å­¦æœ¯</span>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span class="text-gray-300">ğŸ“… 2025å¹´10æœˆ</span>
                        <span class="text-yellow-400">ğŸ† è¯¾ä»¶</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <i class="fa fa-cubes text-primary text-2xl animate-pulse"></i>
                <h1 class="text-xl md:text-2xl font-bold text-shadow">ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹ <span class="text-accent">æ¸¸æˆä¹‹æ—…</span></h1>
            </div>

            <nav class="hidden md:flex items-center space-x-6">
                <a href="#intro" class="hover:text-primary transition-colors">è¯¾ç¨‹ä»‹ç»</a>
                <a href="#concepts" class="hover:text-primary transition-colors">æ ¸å¿ƒæ¦‚å¿µ</a>
                <a href="#examples" class="hover:text-primary transition-colors">ä¾‹é¢˜è§£æ</a>
                <a href="#practice" class="hover:text-primary transition-colors">å®æˆ˜ç»ƒä¹ </a>
                <a href="#game"
                    class="bg-gradient-to-r from-primary to-secondary px-4 py-2 rounded-full hover:opacity-90 transition-opacity">è¿›å…¥æ¸¸æˆ</a>
                <button id="fullscreenBtn"
                    class="px-4 py-2 border border-primary/50 rounded-full hover:bg-primary/10 transition-colors">
                    <i class="fa fa-expand"></i> å…¨å±æ¨¡å¼
                </button>
            </nav>

            <!-- ç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
            <button class="md:hidden text-2xl" id="menuToggle">
                <i class="fa fa-bars"></i>
            </button>
        </div>

        <!-- ç§»åŠ¨ç«¯èœå• -->
        <div class="md:hidden hidden bg-dark/95 backdrop-blur-md" id="mobileMenu">
            <div class="container mx-auto px-4 py-3 flex flex-col space-y-4">
                <a href="#intro" class="hover:text-primary transition-colors py-2 border-b border-gray-700">è¯¾ç¨‹ä»‹ç»</a>
                <a href="#concepts" class="hover:text-primary transition-colors py-2 border-b border-gray-700">æ ¸å¿ƒæ¦‚å¿µ</a>
                <a href="#examples" class="hover:text-primary transition-colors py-2 border-b border-gray-700">ä¾‹é¢˜è§£æ</a>
                <a href="#practice" class="hover:text-primary transition-colors py-2 border-b border-gray-700">å®æˆ˜ç»ƒä¹ </a>
                <a href="#game"
                    class="bg-gradient-to-r from-primary to-secondary px-4 py-2 rounded-full hover:opacity-90 transition-opacity text-center">è¿›å…¥æ¸¸æˆ</a>
                <button id="mobileFullscreenBtn"
                    class="px-4 py-2 border border-primary/50 rounded-full hover:bg-primary/10 transition-colors text-center">
                    <i class="fa fa-expand"></i> å…¨å±æ¨¡å¼
                </button>
            </div>
        </div>
    </header>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="container mx-auto px-4 pt-32 pb-16">
        <!-- è‹±é›„åŒºåŸŸ -->
        <section id="intro" class="min-h-screen flex flex-col justify-center items-center text-center py-16 parallax">
            <div class="perspective-1000 animate-fade-in-up">
                <div class="card-3d hologram rounded-2xl p-8 md:p-12 shadow-2xl max-w-5xl">
                    <div class="mb-8">
                        <h2 class="text-4xl md:text-6xl font-bold mb-6 font-space text-shadow-glow animate-glow">
                            ç¬¬äºŒåä¸€ç«  ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹
                        </h2>
                        <div class="w-24 h-1 bg-gradient-to-r from-primary to-accent mx-auto mb-8 rounded-full"></div>
                    </div>

                    <div class="mb-12">
                        <p class="text-lg md:text-xl mb-8 leading-relaxed">
                            åœ¨é¥è¿œçš„å¤ªç©ºä¸­ï¼Œæ•°å­¦å®šå¾‹å¦‚æ˜Ÿè¾°èˆ¬é—ªè€€ã€‚ä»Šå¤©æˆ‘ä»¬å°†æ¢ç´¢ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„å¥¥ç§˜ï¼Œ
                            å°±åƒæ¢ç´¢å®‡å®™ä¸­çš„é»„é‡‘æ¯”ä¾‹ä¸€æ ·ç¥å¥‡...
                        </p>

                        <!-- å¤ªç©ºé›•åƒå¯è§†åŒ– -->
                        <div class="flex justify-center my-12">
                            <div class="relative">
                                <!-- 3Då¤ªç©ºé›•åƒ -->
                                <div class="relative w-64 h-96 mx-auto">
                                    <canvas id="spaceStatue" width="256" height="384"
                                        class="rounded-2xl shadow-2xl"></canvas>
                                    <div
                                        class="absolute -inset-4 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-2xl blur-xl animate-pulse-slow">
                                    </div>
                                </div>

                                <!-- æ–¹ç¨‹æ˜¾ç¤º -->
                                <div class="mt-8 space-y-4">
                                    <div
                                        class="equation text-xl md:text-2xl p-4 glass-effect rounded-lg hologram-border">
                                        AC : BC = BC : 2, å³ BCÂ² = 2AC
                                    </div>

                                    <div class="text-lg mb-4">è®¾é›•åƒä¸‹éƒ¨é«˜ x å…‰å¹´ï¼Œå¯å¾—æ–¹ç¨‹:</div>

                                    <div class="equation text-xl md:text-2xl p-4 glass-effect rounded-lg">
                                        xÂ² = 2(2 - x)
                                    </div>

                                    <div class="text-lg mb-4">æ•´ç†å¾—:</div>

                                    <div
                                        class="equation text-2xl md:text-3xl p-6 hologram rounded-lg border-l-4 border-accent animate-glow">
                                        xÂ² + 2x - 4 = 0
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-center">
                        <a href="#concepts"
                            class="interactive-btn flex items-center space-x-3 bg-gradient-to-r from-primary via-secondary to-accent px-8 py-4 rounded-full hover:opacity-90 transition-all duration-300 text-lg font-space shadow-2xl">
                            <i class="fa fa-rocket"></i>
                            <span>å¼€å§‹å¤ªç©ºæ¢ç´¢</span>
                            <i class="fa fa-arrow-down animate-bounce"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ ¸å¿ƒæ¦‚å¿µéƒ¨åˆ† -->
        <section id="concepts" class="py-20 parallax">
            <div class="text-center mb-16 animate-fade-in-up">
                <h2 class="text-4xl md:text-5xl font-bold mb-6 font-space text-shadow-glow">æ ¸å¿ƒç†è®ºæ¨¡å—</h2>
                <div class="w-32 h-1 bg-gradient-to-r from-primary to-accent mx-auto rounded-full"></div>
                <p class="text-xl mt-6 text-space-400">æ¢ç´¢æ•°å­¦å®‡å®™ä¸­çš„åŸºæœ¬å®šå¾‹</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- æ¦‚å¿µå¡ç‰‡1 -->
                <div
                    class="card-3d hologram rounded-xl p-8 hover:border-primary/60 transition-all duration-500 animate-slide-in-left">
                    <div class="text-center mb-6">
                        <div
                            class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-primary to-secondary rounded-full flex items-center justify-center">
                            <i class="fa fa-square-o text-2xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 font-space">æ–¹ç¨‹å®šä¹‰</h3>
                    </div>

                    <p class="mb-6 leading-relaxed">
                        åœ¨æ•°å­¦å®‡å®™ä¸­ï¼Œä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æ˜¯åªå«æœ‰ä¸€ä¸ªæœªçŸ¥æ•°ï¼Œä¸”æœªçŸ¥æ•°æœ€é«˜æ¬¡æ•°ä¸º2çš„æ–¹ç¨‹ï¼Œ
                        å®ƒä»¬éµå¾ªç€å®‡å®™çš„åŸºæœ¬æ•°å­¦å®šå¾‹ã€‚
                    </p>

                    <div class="equation text-lg p-4 glass-effect rounded-lg text-center font-space">
                        axÂ² + bx + c = 0 (a â‰  0)
                    </div>

                    <!-- å®æ—¶å‡½æ•°å›¾åƒ -->
                    <div class="mt-6">
                        <canvas id="conceptGraph1" width="280" height="200"
                            class="w-full function-graph rounded-lg"></canvas>
                    </div>
                </div>

                <!-- æ¦‚å¿µå¡ç‰‡2 -->
                <div class="card-3d hologram rounded-xl p-8 hover:border-secondary/60 transition-all duration-500 animate-fade-in-up"
                    style="animation-delay: 0.2s;">
                    <div class="text-center mb-6">
                        <div
                            class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-secondary to-accent rounded-full flex items-center justify-center">
                            <i class="fa fa-list-ol text-2xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 font-space">æ ‡å‡†å½¢å¼</h3>
                    </div>

                    <p class="mb-4">ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹çš„æ ‡å‡†å½¢å¼åŒ…å«ä¸‰ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼š</p>

                    <div class="equation text-lg p-4 glass-effect rounded-lg mb-4 text-center font-space">
                        axÂ² + bx + c = 0 (a â‰  0)
                    </div>

                    <ul class="space-y-2 mb-6">
                        <li class="flex items-center"><span class="w-2 h-2 bg-primary rounded-full mr-3"></span>axÂ²
                            æ˜¯äºŒæ¬¡é¡¹ï¼Œa æ˜¯äºŒæ¬¡é¡¹ç³»æ•°</li>
                        <li class="flex items-center"><span class="w-2 h-2 bg-secondary rounded-full mr-3"></span>bx
                            æ˜¯ä¸€æ¬¡é¡¹ï¼Œb æ˜¯ä¸€æ¬¡é¡¹ç³»æ•°</li>
                        <li class="flex items-center"><span class="w-2 h-2 bg-accent rounded-full mr-3"></span>c æ˜¯å¸¸æ•°é¡¹
                        </li>
                    </ul>

                    <!-- äº¤äº’å¼ç³»æ•°è°ƒèŠ‚å™¨ -->
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <label class="text-sm font-space">a:</label>
                            <input type="range" min="-5" max="5" step="0.1" value="1" class="coefficient-slider"
                                data-coeff="a">
                            <span class="coeff-value w-12 text-center">1</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <label class="text-sm font-space">b:</label>
                            <input type="range" min="-10" max="10" step="0.1" value="0" class="coefficient-slider"
                                data-coeff="b">
                            <span class="coeff-value w-12 text-center">0</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <label class="text-sm font-space">c:</label>
                            <input type="range" min="-10" max="10" step="0.1" value="0" class="coefficient-slider"
                                data-coeff="c">
                            <span class="coeff-value w-12 text-center">0</span>
                        </div>
                    </div>
                </div>

                <!-- æ¦‚å¿µå¡ç‰‡3 -->
                <div class="card-3d hologram rounded-xl p-8 hover:border-accent/60 transition-all duration-500 animate-slide-in-right"
                    style="animation-delay: 0.4s;">
                    <div class="text-center mb-6">
                        <div
                            class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-accent to-primary rounded-full flex items-center justify-center">
                            <i class="fa fa-check-circle-o text-2xl text-white"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 font-space">æ–¹ç¨‹çš„æ ¹</h3>
                    </div>

                    <p class="mb-6 leading-relaxed">
                        åœ¨æ•°å­¦å®‡å®™ä¸­ï¼Œæ–¹ç¨‹çš„æ ¹å°±åƒæ’æ˜Ÿçš„åæ ‡ï¼Œ
                        å®ƒä»¬æ˜¯ä½¿æ–¹ç¨‹å·¦å³ä¸¤è¾¹ç›¸ç­‰çš„ç‰¹æ®Šæ•°å€¼ã€‚
                    </p>

                    <div class="glass-effect p-4 rounded-lg mb-6">
                        <p class="italic text-center font-space">
                            ä¾‹å¦‚ï¼šx = 2 æ˜¯æ–¹ç¨‹ xÂ² - 4 = 0 çš„æ ¹
                        </p>
                    </div>

                    <!-- æ ¹çš„å¯è§†åŒ– -->
                    <div class="mt-6">
                        <canvas id="rootsVisualization" width="280" height="200"
                            class="w-full function-graph rounded-lg"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- ä¾‹é¢˜è§£æéƒ¨åˆ† -->
        <section id="examples" class="py-20 parallax">
            <div class="text-center mb-16 animate-fade-in-up">
                <h2 class="text-4xl md:text-5xl font-bold mb-6 font-space text-shadow-glow">å®ä¾‹åˆ†æ</h2>
                <div class="w-32 h-1 bg-gradient-to-r from-secondary to-primary mx-auto rounded-full"></div>
                <p class="text-xl mt-6 text-space-400">é€šè¿‡å¤ªç©ºä»»åŠ¡å­¦ä¹ æ–¹ç¨‹åº”ç”¨</p>
            </div>

            <!-- ä¾‹é¢˜1ï¼šå¤ªç©ºèˆ±è®¾è®¡ -->
            <div class="card-3d hologram rounded-2xl p-8 md:p-12 mb-16 animate-zoom-in">
                <h3 class="text-3xl font-bold mb-8 text-primary font-space">
                    <i class="fa fa-rocket mr-4"></i>
                    ä»»åŠ¡ä¸€ï¼šå¤ªç©ºèˆ±è®¾è®¡
                </h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                    <div class="space-y-6">
                        <div class="glass-effect p-6 rounded-xl">
                            <p class="text-lg leading-relaxed mb-6">
                                å¤ªç©ºå·¥ç¨‹å¸ˆéœ€è¦è®¾è®¡ä¸€ä¸ªçŸ©å½¢å¤ªç©ºèˆ±åº•æ¿ã€‚å·²çŸ¥åº•æ¿é•¿ 100 ç±³ï¼Œå®½ 50 ç±³ã€‚
                                ä¸ºäº†å®‰è£…æ¨è¿›å™¨ï¼Œéœ€è¦åœ¨å››è§’å„åˆ‡å»ä¸€ä¸ªç›¸åŒçš„æ­£æ–¹å½¢åŒºåŸŸï¼Œ
                                ç„¶åå°†å››å‘¨æŠ˜èµ·å½¢æˆèˆ±å£ã€‚å¦‚æœè¦æ±‚åº•æ¿é¢ç§¯ä¸º 3600 å¹³æ–¹ç±³ï¼Œ
                                é‚£ä¹ˆæ¯ä¸ªè§’åº”è¯¥åˆ‡å»å¤šå¤§çš„æ­£æ–¹å½¢ï¼Ÿ
                            </p>
                        </div>

                        <div class="space-y-4">
                            <p class="text-lg font-space">è®¾åˆ‡å»çš„æ­£æ–¹å½¢è¾¹é•¿ä¸º x ç±³ï¼Œåˆ™ï¼š</p>

                            <ul class="space-y-2 ml-6">
                                <li class="flex items-center">
                                    <span class="w-2 h-2 bg-primary rounded-full mr-3"></span>
                                    åº•æ¿é•¿ä¸º (100 - 2x) ç±³
                                </li>
                                <li class="flex items-center">
                                    <span class="w-2 h-2 bg-secondary rounded-full mr-3"></span>
                                    åº•æ¿å®½ä¸º (50 - 2x) ç±³
                                </li>
                            </ul>

                            <div class="equation text-xl p-4 glass-effect rounded-lg font-space">
                                (100 - 2x)(50 - 2x) = 3600
                            </div>

                            <div class="equation text-xl p-4 glass-effect rounded-lg font-space">
                                å±•å¼€ï¼š5000 - 300x + 4xÂ² = 3600
                            </div>

                            <div
                                class="equation text-2xl p-6 hologram rounded-lg border-l-4 border-accent font-space animate-glow">
                                4xÂ² - 300x + 1400 = 0
                            </div>

                            <div class="equation text-xl p-4 glass-effect rounded-lg font-space">
                                åŒ–ç®€ï¼šxÂ² - 75x + 350 = 0
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col justify-center">
                        <!-- 3Då¤ªç©ºèˆ±å¯è§†åŒ– -->
                        <div class="relative mb-8">
                            <canvas id="spacecraftDesign" width="400" height="300"
                                class="w-full function-graph rounded-xl shadow-2xl"></canvas>
                            <div
                                class="absolute -inset-2 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-xl blur-lg animate-pulse-slow">
                            </div>
                        </div>

                        <!-- å®æ—¶è®¡ç®—å™¨ -->
                        <div class="glass-effect p-6 rounded-xl">
                            <h4 class="text-xl font-bold mb-4 font-space text-center">å®æ—¶æ±‚è§£å™¨</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <label class="font-space">åˆ‡é™¤è¾¹é•¿ x:</label>
                                    <input type="range" min="1" max="20" step="0.1" value="5" id="cutSize"
                                        class="flex-1 mx-4">
                                    <span id="cutValue" class="w-16 text-center font-space">5</span>
                                </div>
                                <div class="text-center space-y-2">
                                    <div>åº•æ¿é•¿åº¦: <span id="resultLength" class="font-space text-primary">90</span> ç±³</div>
                                    <div>åº•æ¿å®½åº¦: <span id="resultWidth" class="font-space text-secondary">40</span> ç±³
                                    </div>
                                    <div>åº•æ¿é¢ç§¯: <span id="resultArea" class="font-space text-accent">3600</span> å¹³æ–¹ç±³
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ä¾‹é¢˜2ï¼šå«æ˜Ÿè½¨é“è®¡ç®— -->
            <div class="card-3d hologram rounded-2xl p-8 md:p-12 animate-zoom-in" style="animation-delay: 0.3s;">
                <h3 class="text-3xl font-bold mb-8 text-secondary font-space flex items-center">
                    <i class="fa fa-globe mr-4"></i>
                    ä»»åŠ¡äºŒï¼šå«æ˜Ÿè½¨é“è®¡ç®—
                </h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                    <div class="space-y-6">
                        <div class="glass-effect p-6 rounded-xl">
                            <p class="text-lg leading-relaxed mb-6">
                                å¤ªç©ºç«èµ›ä¸­ï¼Œéœ€è¦å®‰æ’å«æ˜Ÿä¹‹é—´çš„é€šä¿¡ã€‚å‚èµ›çš„æ¯ä¸¤é¢—å«æ˜Ÿä¹‹é—´éƒ½è¦å»ºç«‹ä¸€æ¡é€šä¿¡é“¾è·¯ã€‚
                                æ ¹æ®èƒ½æºå’Œæ—¶é—´é™åˆ¶ï¼Œè®¡åˆ’å®‰æ’ 7 å¤©å®Œæˆæ‰€æœ‰é“¾è·¯å»ºè®¾ï¼Œæ¯å¤©å»ºè®¾ 4 æ¡é“¾è·¯ã€‚
                                è¯·é—®åº”è¯¥éƒ¨ç½²å¤šå°‘é¢—å«æ˜Ÿï¼Ÿ
                            </p>
                        </div>

                        <div class="space-y-4">
                            <p class="text-lg font-space">åˆ†æè¿‡ç¨‹ï¼š</p>

                            <ul class="space-y-3 ml-6">
                                <li class="flex items-start">
                                    <span class="w-2 h-2 bg-primary rounded-full mr-3 mt-2"></span>
                                    <span>æ€»é€šä¿¡é“¾è·¯æ•°ï¼š4 Ã— 7 = 28 æ¡</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="w-2 h-2 bg-secondary rounded-full mr-3 mt-2"></span>
                                    <span>è®¾éƒ¨ç½² x é¢—å«æ˜Ÿ</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="w-2 h-2 bg-accent rounded-full mr-3 mt-2"></span>
                                    <span>æ¯é¢—å«æ˜Ÿä¸å…¶ä»– (x-1) é¢—å«æ˜Ÿé€šä¿¡</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="w-2 h-2 bg-primary rounded-full mr-3 mt-2"></span>
                                    <span>æ€»é“¾è·¯æ•°ï¼šÂ½x(x-1) æ¡</span>
                                </li>
                            </ul>

                            <div class="equation text-xl p-4 glass-effect rounded-lg font-space">
                                Â½x(x - 1) = 28
                            </div>

                            <div class="equation text-xl p-4 glass-effect rounded-lg font-space">
                                x(x - 1) = 56
                            </div>

                            <div
                                class="equation text-2xl p-6 hologram rounded-lg border-l-4 border-accent font-space animate-glow">
                                xÂ² - x - 56 = 0
                            </div>
                        </div>
                    </div>

                    <div class="flex flex-col justify-center">
                        <!-- å«æ˜Ÿç½‘ç»œå¯è§†åŒ– -->
                        <div class="relative mb-8">
                            <canvas id="satelliteNetwork" width="400" height="300"
                                class="w-full function-graph rounded-xl shadow-2xl"></canvas>
                            <div
                                class="absolute -inset-2 bg-gradient-to-r from-secondary/20 to-accent/20 rounded-xl blur-lg animate-pulse-slow">
                            </div>
                        </div>

                        <!-- ç½‘ç»œè®¡ç®—å™¨ -->
                        <div class="glass-effect p-6 rounded-xl">
                            <h4 class="text-xl font-bold mb-4 font-space text-center">ç½‘ç»œåˆ†æå™¨</h4>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <label class="font-space">å«æ˜Ÿæ•°é‡:</label>
                                    <input type="range" min="2" max="15" step="1" value="8" id="satelliteCount"
                                        class="flex-1 mx-4">
                                    <span id="satelliteValue" class="w-16 text-center font-space">8</span>
                                </div>
                                <div class="text-center space-y-2">
                                    <div>é€šä¿¡é“¾è·¯: <span id="linkCount" class="font-space text-primary">28</span> æ¡</div>
                                    <div>å»ºè®¾å¤©æ•°: <span id="buildDays" class="font-space text-secondary">7</span> å¤©</div>
                                    <div>æ¯å¤©é“¾è·¯: <span id="dailyLinks" class="font-space text-accent">4</span> æ¡</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- å®æˆ˜ç»ƒä¹ éƒ¨åˆ† -->
        <section id="practice" class="py-20 parallax">
            <div class="text-center mb-16 animate-fade-in-up">
                <h2 class="text-4xl md:text-5xl font-bold mb-6 font-space text-shadow-glow">å®æˆ˜è®­ç»ƒ</h2>
                <div class="w-32 h-1 bg-gradient-to-r from-accent to-secondary mx-auto rounded-full"></div>
                <p class="text-xl mt-6 text-space-400">åœ¨å¤ªç©ºæ¨¡æ‹Ÿå™¨ä¸­æµ‹è¯•ä½ çš„æŠ€èƒ½</p>
            </div>

            <!-- ç»ƒä¹ é¢˜ç›® -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                <!-- ç»ƒä¹ 1 -->
                <div class="card-3d hologram rounded-xl p-8 animate-slide-in-left">
                    <h3 class="text-2xl font-bold mb-6 text-primary font-space">ç»ƒä¹  1ï¼šå¤ªç©ºç«™æ‰©å»º</h3>

                    <div class="glass-effect p-6 rounded-lg mb-6">
                        <p class="mb-4">
                            å¤ªç©ºç«™çš„çŸ©å½¢å¤ªé˜³èƒ½æ¿é•¿ä¸º 20 ç±³ï¼Œå®½ä¸º 15 ç±³ã€‚
                            ä¸ºäº†å¢åŠ å‘ç”µé‡ï¼Œéœ€è¦åœ¨é•¿å’Œå®½ä¸Šå„å¢åŠ ç›¸åŒçš„é•¿åº¦ï¼Œ
                            ä½¿é¢ç§¯å¢åŠ åˆ° 500 å¹³æ–¹ç±³ã€‚æ±‚å¢åŠ çš„é•¿åº¦ã€‚
                        </p>
                    </div>

                    <div class="space-y-4">
                        <div class="equation text-lg p-3 glass-effect rounded-lg font-space">
                            è®¾å¢åŠ é•¿åº¦ä¸º x ç±³
                        </div>
                        <div class="equation text-lg p-3 glass-effect rounded-lg font-space">
                            (20 + x)(15 + x) = 500
                        </div>
                    </div>

                    <!-- ç­”æ¡ˆè¾“å…¥ -->
                    <div class="mt-6 space-y-4">
                        <div class="flex items-center space-x-4">
                            <label class="font-space">ä½ çš„ç­”æ¡ˆ:</label>
                            <input type="number" step="0.1"
                                class="practice-input flex-1 p-2 bg-dark/50 border border-primary/30 rounded-lg text-center font-space"
                                placeholder="è¾“å…¥ x çš„å€¼">
                            <button
                                class="check-answer interactive-btn bg-primary px-4 py-2 rounded-lg font-space">æ£€æŸ¥</button>
                        </div>
                        <div class="answer-feedback hidden p-3 rounded-lg"></div>
                    </div>
                </div>

                <!-- ç»ƒä¹ 2 -->
                <div class="card-3d hologram rounded-xl p-8 animate-slide-in-right" style="animation-delay: 0.2s;">
                    <h3 class="text-2xl font-bold mb-6 text-secondary font-space">ç»ƒä¹  2ï¼šè¡Œæ˜Ÿæ¢æµ‹å™¨</h3>

                    <div class="glass-effect p-6 rounded-lg mb-6">
                        <p class="mb-4">
                            ä¸€ä¸ªæ¢æµ‹å™¨ä»é«˜åº¦ h ç±³å¤„è‡ªç”±ä¸‹è½ï¼Œä¸‹è½æ—¶é—´ t ç§’æ»¡è¶³æ–¹ç¨‹ï¼š
                            h = 5tÂ²ã€‚å¦‚æœæ¢æµ‹å™¨ä¸‹è½äº† 3.2 ç§’ï¼Œæ±‚åˆå§‹é«˜åº¦ã€‚
                        </p>
                    </div>

                    <div class="space-y-4">
                        <div class="equation text-lg p-3 glass-effect rounded-lg font-space">
                            h = 5tÂ²
                        </div>
                        <div class="equation text-lg p-3 glass-effect rounded-lg font-space">
                            h = 5 Ã— (3.2)Â²
                        </div>
                    </div>

                    <!-- ç­”æ¡ˆè¾“å…¥ -->
                    <div class="mt-6 space-y-4">
                        <div class="flex items-center space-x-4">
                            <label class="font-space">åˆå§‹é«˜åº¦:</label>
                            <input type="number" step="0.1"
                                class="practice-input flex-1 p-2 bg-dark/50 border border-secondary/30 rounded-lg text-center font-space"
                                placeholder="è¾“å…¥é«˜åº¦å€¼">
                            <button
                                class="check-answer interactive-btn bg-secondary px-4 py-2 rounded-lg font-space">æ£€æŸ¥</button>
                        </div>
                        <div class="answer-feedback hidden p-3 rounded-lg"></div>
                    </div>
                </div>
            </div>

            <!-- ç»¼åˆå‡½æ•°å›¾åƒåˆ†æå™¨ -->
            <div class="card-3d hologram rounded-2xl p-8 md:p-12 animate-zoom-in">
                <h3 class="text-3xl font-bold mb-8 text-center font-space text-shadow-glow">
                    <i class="fa fa-line-chart mr-4"></i>
                    å¤ªç©ºå‡½æ•°åˆ†æå™¨
                </h3>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- æ§åˆ¶é¢æ¿ -->
                    <div class="glass-effect p-6 rounded-xl">
                        <h4 class="text-xl font-bold mb-6 font-space text-center">æ§åˆ¶ä¸­å¿ƒ</h4>

                        <div class="space-y-6">
                            <!-- ç³»æ•°æ§åˆ¶ -->
                            <div class="space-y-4">
                                <h5 class="font-space text-lg">æ–¹ç¨‹ç³»æ•°</h5>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between">
                                        <label class="font-space">a:</label>
                                        <input type="range" min="-3" max="3" step="0.1" value="1" id="mainCoeffA"
                                            class="flex-1 mx-3">
                                        <span id="mainValueA" class="w-12 text-center font-space">1</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <label class="font-space">b:</label>
                                        <input type="range" min="-10" max="10" step="0.1" value="0" id="mainCoeffB"
                                            class="flex-1 mx-3">
                                        <span id="mainValueB" class="w-12 text-center font-space">0</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <label class="font-space">c:</label>
                                        <input type="range" min="-10" max="10" step="0.1" value="0" id="mainCoeffC"
                                            class="flex-1 mx-3">
                                        <span id="mainValueC" class="w-12 text-center font-space">0</span>
                                    </div>
                                </div>
                            </div>

                            <!-- å½“å‰æ–¹ç¨‹æ˜¾ç¤º -->
                            <div class="glass-effect p-4 rounded-lg">
                                <div class="text-center">
                                    <div class="text-sm text-space-400 mb-2">å½“å‰æ–¹ç¨‹</div>
                                    <div id="currentEquation" class="equation text-lg font-space">y = xÂ²</div>
                                </div>
                            </div>

                            <!-- æ ¹çš„ä¿¡æ¯ -->
                            <div class="glass-effect p-4 rounded-lg">
                                <div class="text-center">
                                    <div class="text-sm text-space-400 mb-2">æ–¹ç¨‹çš„æ ¹</div>
                                    <div id="rootsInfo" class="font-space text-sm">xâ‚ = 0, xâ‚‚ = 0</div>
                                </div>
                            </div>

                            <!-- é¢„è®¾æ–¹ç¨‹ -->
                            <div>
                                <h5 class="font-space text-lg mb-3">é¢„è®¾æ–¹ç¨‹</h5>
                                <div class="space-y-2">
                                    <button
                                        class="preset-equation w-full p-2 glass-effect rounded-lg text-sm font-space hover:border-primary/50 transition-all"
                                        data-a="1" data-b="0" data-c="-4">
                                        xÂ² - 4 = 0
                                    </button>
                                    <button
                                        class="preset-equation w-full p-2 glass-effect rounded-lg text-sm font-space hover:border-primary/50 transition-all"
                                        data-a="1" data-b="-5" data-c="6">
                                        xÂ² - 5x + 6 = 0
                                    </button>
                                    <button
                                        class="preset-equation w-full p-2 glass-effect rounded-lg text-sm font-space hover:border-primary/50 transition-all"
                                        data-a="2" data-b="4" data-c="-6">
                                        2xÂ² + 4x - 6 = 0
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ä¸»å›¾åƒæ˜¾ç¤º -->
                    <div class="lg:col-span-2">
                        <div class="relative">
                            <canvas id="mainFunctionGraph" width="600" height="400"
                                class="w-full function-graph rounded-xl shadow-2xl"></canvas>
                            <div
                                class="absolute -inset-2 bg-gradient-to-r from-primary/10 via-secondary/10 to-accent/10 rounded-xl blur-lg animate-pulse-slow">
                            </div>
                        </div>

                        <!-- å›¾åƒä¿¡æ¯é¢æ¿ -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                            <div class="glass-effect p-4 rounded-lg text-center">
                                <div class="text-sm text-space-400">é¡¶ç‚¹åæ ‡</div>
                                <div id="vertexInfo" class="font-space text-primary">(-0, 0)</div>
                            </div>
                            <div class="glass-effect p-4 rounded-lg text-center">
                                <div class="text-sm text-space-400">åˆ¤åˆ«å¼ Î”</div>
                                <div id="discriminantInfo" class="font-space text-secondary">0</div>
                            </div>
                            <div class="glass-effect p-4 rounded-lg text-center">
                                <div class="text-sm text-space-400">å¼€å£æ–¹å‘</div>
                                <div id="directionInfo" class="font-space text-accent">å‘ä¸Š</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- æ¸¸æˆåŒºåŸŸ -->
        <section id="game" class="py-20 parallax">
            <div class="text-center mb-16 animate-fade-in-up">
                <h2 class="text-4xl md:text-5xl font-bold mb-6 font-space text-shadow-glow">å¤ªç©ºä»»åŠ¡ä¸­å¿ƒ</h2>
                <div class="w-32 h-1 bg-gradient-to-r from-primary to-accent mx-auto rounded-full"></div>
                <p class="text-xl mt-6 text-space-400">å‡†å¤‡å¥½å¼€å§‹ä½ çš„å¤ªç©ºæ•°å­¦å†’é™©äº†å—ï¼Ÿ</p>
            </div>

            <div class="card-3d hologram rounded-2xl p-8 md:p-12 text-center animate-zoom-in">
                <div class="mb-8">
                    <div
                        class="w-32 h-32 mx-auto mb-6 bg-gradient-to-br from-primary via-secondary to-accent rounded-full flex items-center justify-center animate-float">
                        <i class="fa fa-rocket text-4xl text-white"></i>
                    </div>
                    <h3 class="text-3xl font-bold mb-4 font-space">ä»»åŠ¡å³å°†å¼€å§‹</h3>
                    <p class="text-xl text-space-400 mb-8">
                        åœ¨æµ©ç€šçš„æ•°å­¦å®‡å®™ä¸­ï¼Œä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å°±åƒå¯¼èˆªæ˜Ÿå›¾ï¼Œ
                        æŒ‡å¼•ç€æˆ‘ä»¬æ¢ç´¢æœªçŸ¥çš„æ•°å­¦æ˜Ÿç³»ã€‚
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                    <div class="glass-effect p-6 rounded-xl">
                        <i class="fa fa-trophy text-3xl text-primary mb-4"></i>
                        <h4 class="text-xl font-bold mb-2 font-space">æŒ‘æˆ˜å…³å¡</h4>
                        <p class="text-space-400">å®Œæˆå„ç§å¤ªç©ºä»»åŠ¡ï¼ŒæŒæ¡æ–¹ç¨‹æ±‚è§£æŠ€å·§</p>
                    </div>
                    <div class="glass-effect p-6 rounded-xl">
                        <i class="fa fa-line-chart text-3xl text-secondary mb-4"></i>
                        <h4 class="text-xl font-bold mb-2 font-space">å®æ—¶å¯è§†åŒ–</h4>
                        <p class="text-space-400">è§‚å¯Ÿå‡½æ•°å›¾åƒçš„å®æ—¶å˜åŒ–å’Œæ€§è´¨</p>
                    </div>
                    <div class="glass-effect p-6 rounded-xl">
                        <i class="fa fa-users text-3xl text-accent mb-4"></i>
                        <h4 class="text-xl font-bold mb-2 font-space">åä½œæ¢ç´¢</h4>
                        <p class="text-space-400">ä¸å…¶ä»–å¤ªç©ºæ¢ç´¢è€…ä¸€èµ·å­¦ä¹ æˆé•¿</p>
                    </div>
                </div>

                <button id="startGameBtn"
                    class="interactive-btn bg-gradient-to-r from-primary via-secondary to-accent px-12 py-4 rounded-full text-xl font-space shadow-2xl hover:scale-105 transition-all duration-300">
                    <i class="fa fa-play mr-3"></i>
                    å¯åŠ¨å¤ªç©ºä»»åŠ¡
                    <i class="fa fa-rocket ml-3"></i>
                </button>
            </div>
        </section>
    </main>

    <!-- é¡µè„š -->
    <footer class="glass-effect py-12 mt-20">
        <div class="container mx-auto px-4 text-center">
            <div class="mb-6">
                <div class="flex justify-center items-center space-x-3 mb-4">
                    <i class="fa fa-rocket text-primary text-2xl animate-float"></i>
                    <h3 class="text-2xl font-bold font-space">å¤ªç©ºæ•°å­¦æ¢ç´¢</h3>
                </div>
                <p class="text-space-400">åœ¨æ•°å­¦çš„å®‡å®™ä¸­ï¼Œæ¯ä¸€ä¸ªæ–¹ç¨‹éƒ½æ˜¯ä¸€é¢—é—ªäº®çš„æ˜Ÿæ˜Ÿ</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                <div>
                    <h4 class="font-bold mb-3 font-space">å­¦ä¹ èµ„æº</h4>
                    <ul class="space-y-2 text-space-400">
                        <li><a href="#" class="hover:text-primary transition-colors">åŸºç¡€ç†è®º</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">è¿›é˜¶ç»ƒä¹ </a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">å®æˆ˜åº”ç”¨</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-3 font-space">å·¥å…·ç®±</h4>
                    <ul class="space-y-2 text-space-400">
                        <li><a href="#" class="hover:text-secondary transition-colors">æ–¹ç¨‹æ±‚è§£å™¨</a></li>
                        <li><a href="#" class="hover:text-secondary transition-colors">å›¾åƒç»˜åˆ¶å™¨</a></li>
                        <li><a href="#" class="hover:text-secondary transition-colors">ç»ƒä¹ ç”Ÿæˆå™¨</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-3 font-space">ç¤¾åŒº</h4>
                    <ul class="space-y-2 text-space-400">
                        <li><a href="#" class="hover:text-accent transition-colors">è®¨è®ºè®ºå›</a></li>
                        <li><a href="#" class="hover:text-accent transition-colors">å­¦ä¹ å°ç»„</a></li>
                        <li><a href="#" class="hover:text-accent transition-colors">æˆå°±å±•ç¤º</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-space-300 pt-6">
                <p class="text-space-400">&copy; 2046 å¤ªç©ºæ•°å­¦æ¢ç´¢. åœ¨çŸ¥è¯†çš„å®‡å®™ä¸­è‡ªç”±ç¿±ç¿”.</p>
            </div>
        </div>
    </footer>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function () {
            // åˆå§‹åŒ–æ‰€æœ‰Canvaså›¾åƒ
            drawConceptGraph1();
            drawRootsVisualization();
            initSpacecraftSolver();
            initSatelliteAnalyzer();
            drawSpaceStatue();
            drawMainFunctionGraph();

            // åˆå§‹åŒ–æ ‡å‡†å½¢å¼ç³»æ•°æ»‘æ†
            initStandardFormSliders();

            // åˆå§‹åŒ–å¤ªç©ºå‡½æ•°åˆ†æå™¨
            initMainFunctionAnalyzer();

            // åˆå§‹åŒ–ç»ƒä¹ ç³»ç»Ÿ
            initPracticeSystem();

            // åˆå§‹åŒ–åŠ¨ç”»æ•ˆæœ
            initAnimations();

            // åˆå§‹åŒ–ç§»åŠ¨ç«¯èœå•
            initMobileMenu();
        });

        // åˆå§‹åŒ–æ ‡å‡†å½¢å¼ç³»æ•°æ»‘æ†
        function initStandardFormSliders() {
            const sliders = document.querySelectorAll('.coefficient-slider');
            const values = document.querySelectorAll('.coeff-value');

            sliders.forEach((slider, index) => {
                const valueSpan = values[index];

                // åˆå§‹åŒ–æ˜¾ç¤ºå€¼
                valueSpan.textContent = slider.value;

                // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                slider.addEventListener('input', function () {
                    const value = parseFloat(this.value);
                    valueSpan.textContent = value.toFixed(1);

                    // é‡ç»˜æ¦‚å¿µå›¾1ï¼ˆæ ‡å‡†å½¢å¼å¯¹åº”çš„å›¾åƒï¼‰
                    drawConceptGraph1WithCoefficients();
                });
            });
        }

        // ç»˜åˆ¶å¸¦ç³»æ•°çš„æ¦‚å¿µå›¾1
        function drawConceptGraph1WithCoefficients() {
            const canvas = document.getElementById('conceptGraph1');
            if (!canvas) return;

            // è·å–ç³»æ•°å€¼
            const sliders = document.querySelectorAll('.coefficient-slider');
            const a = parseFloat(sliders[0]?.value || 1);
            const b = parseFloat(sliders[1]?.value || 0);
            const c = parseFloat(sliders[2]?.value || 0);

            // è®¾ç½®Canvaså°ºå¯¸
            canvas.width = 280;
            canvas.height = 200;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶ç½‘æ ¼
            ctx.strokeStyle = 'rgba(71, 85, 105, 0.3)';
            ctx.lineWidth = 0.5;

            const gridSize = 20;
            for (let x = 0; x <= width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }

            for (let y = 0; y <= height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;

            const centerX = width / 2;
            const centerY = height / 2;

            // xè½´
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.stroke();

            // yè½´
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();

            // ç»˜åˆ¶æŠ›ç‰©çº¿ y = axÂ² + bx + c
            ctx.strokeStyle = '#0ea5e9';
            ctx.lineWidth = 3;
            ctx.shadowColor = '#0ea5e9';
            ctx.shadowBlur = 10;

            ctx.beginPath();
            let firstPoint = true;

            for (let x = -width / 2; x <= width / 2; x += 2) {
                const realX = x / 20; // ç¼©æ”¾å› å­
                const realY = a * realX * realX + b * realX + c;
                const canvasX = centerX + x;
                const canvasY = centerY - realY * 20; // ç¼©æ”¾å› å­

                if (canvasY >= 0 && canvasY <= height) {
                    if (firstPoint) {
                        ctx.moveTo(canvasX, canvasY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(canvasX, canvasY);
                    }
                }
            }

            ctx.stroke();
            ctx.shadowBlur = 0;

            // æ ‡è®°é¡¶ç‚¹
            const vertexX = -b / (2 * a);
            const vertexY = a * vertexX * vertexX + b * vertexX + c;
            const vertexCanvasX = centerX + vertexX * 20;
            const vertexCanvasY = centerY - vertexY * 20;

            if (vertexCanvasX >= 0 && vertexCanvasX <= width && vertexCanvasY >= 0 && vertexCanvasY <= height) {
                ctx.fillStyle = '#ec4899';
                ctx.beginPath();
                ctx.arc(vertexCanvasX, vertexCanvasY, 4, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        // ç»˜åˆ¶å«æ˜Ÿç½‘ç»œï¼ˆåŠ¨æ€ç‰ˆæœ¬ï¼‰
        function drawSatelliteNetworkDynamic(satelliteCount = 8) {
            const canvas = document.getElementById('satelliteNetwork');
            if (!canvas) return;

            // è®¾ç½®Canvaså°ºå¯¸
            canvas.width = 400;
            canvas.height = 300;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶æ˜Ÿç©ºèƒŒæ™¯
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 50; i++) {
                const x = Math.random() * width;
                const y = Math.random() * height;
                const size = Math.random() * 1.5;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, 2 * Math.PI);
                ctx.fill();
            }

            // è®¡ç®—å«æ˜Ÿä½ç½®ï¼ˆåœ†å½¢æ’åˆ—ï¼‰
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) * 0.35;
            const satellites = [];

            for (let i = 0; i < satelliteCount; i++) {
                const angle = (2 * Math.PI * i) / satelliteCount;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                satellites.push({ x, y, id: i + 1 });
            }

            // ç»˜åˆ¶é€šä¿¡é“¾è·¯
            ctx.strokeStyle = 'rgba(14, 165, 233, 0.4)';
            ctx.lineWidth = 1;

            for (let i = 0; i < satellites.length; i++) {
                for (let j = i + 1; j < satellites.length; j++) {
                    ctx.beginPath();
                    ctx.moveTo(satellites[i].x, satellites[i].y);
                    ctx.lineTo(satellites[j].x, satellites[j].y);
                    ctx.stroke();
                }
            }

            // ç»˜åˆ¶å«æ˜Ÿ
            satellites.forEach((satellite, index) => {
                // å«æ˜Ÿä¸»ä½“
                ctx.fillStyle = '#0ea5e9';
                ctx.beginPath();
                ctx.arc(satellite.x, satellite.y, 8, 0, 2 * Math.PI);
                ctx.fill();

                // å«æ˜Ÿå…‰æ™•
                const gradient = ctx.createRadialGradient(
                    satellite.x, satellite.y, 0,
                    satellite.x, satellite.y, 15
                );
                gradient.addColorStop(0, 'rgba(14, 165, 233, 0.6)');
                gradient.addColorStop(1, 'rgba(14, 165, 233, 0)');

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(satellite.x, satellite.y, 15, 0, 2 * Math.PI);
                ctx.fill();

                // å«æ˜Ÿç¼–å·
                ctx.fillStyle = '#ffffff';
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(satellite.id.toString(), satellite.x, satellite.y + 3);
            });

            // ç»˜åˆ¶åœ°çƒï¼ˆä¸­å¿ƒï¼‰
            ctx.fillStyle = 'rgba(34, 197, 94, 0.8)';
            ctx.beginPath();
            ctx.arc(centerX, centerY, 20, 0, 2 * Math.PI);
            ctx.fill();

            ctx.strokeStyle = '#22c55e';
            ctx.lineWidth = 2;
            ctx.stroke();

            // åœ°çƒæ ‡ç­¾
            ctx.fillStyle = '#ffffff';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('åœ°çƒ', centerX, centerY + 4);

            // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
            const linkCount = (satelliteCount * (satelliteCount - 1)) / 2;
            ctx.fillStyle = '#f59e0b';
            ctx.font = '14px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`å«æ˜Ÿæ•°é‡: ${satelliteCount}`, 10, 25);
            ctx.fillText(`é€šä¿¡é“¾è·¯: ${linkCount} æ¡`, 10, 45);

            // ç›®æ ‡æ£€æŸ¥
            if (linkCount === 28) {
                ctx.fillStyle = '#10b981';
                ctx.fillText('âœ“ è¾¾åˆ°ç›®æ ‡ï¼', 10, 65);
            } else {
                ctx.fillStyle = '#ef4444';
                ctx.fillText(`ç›®æ ‡: 28 æ¡ (å·®å€¼: ${Math.abs(linkCount - 28)})`, 10, 65);
            }
        }

        // åˆå§‹åŒ–å«æ˜Ÿç½‘ç»œåˆ†æå™¨
        function initSatelliteAnalyzer() {
            const satelliteSlider = document.getElementById('satelliteCount');
            const satelliteValueSpan = document.getElementById('satelliteValue');
            const linkCountSpan = document.getElementById('linkCount');

            if (!satelliteSlider) return;

            function updateSatelliteNetwork() {
                const count = parseInt(satelliteSlider.value);
                const linkCount = (count * (count - 1)) / 2;

                // æ›´æ–°æ˜¾ç¤ºå€¼
                satelliteValueSpan.textContent = count;
                linkCountSpan.textContent = linkCount;

                // é‡ç»˜ç½‘ç»œå›¾
                drawSatelliteNetworkDynamic(count);
            }

            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            satelliteSlider.addEventListener('input', updateSatelliteNetwork);

            // åˆå§‹åŒ–
            updateSatelliteNetwork();
        }
        function initMainFunctionAnalyzer() {
            const coeffA = document.getElementById('mainCoeffA');
            const coeffB = document.getElementById('mainCoeffB');
            const coeffC = document.getElementById('mainCoeffC');
            const valueA = document.getElementById('mainValueA');
            const valueB = document.getElementById('mainValueB');
            const valueC = document.getElementById('mainValueC');

            if (!coeffA || !coeffB || !coeffC) return;

            // æ›´æ–°å‡½æ•°
            function updateFunction() {
                const a = parseFloat(coeffA.value);
                const b = parseFloat(coeffB.value);
                const c = parseFloat(coeffC.value);

                // æ›´æ–°æ˜¾ç¤ºå€¼
                valueA.textContent = a.toFixed(1);
                valueB.textContent = b.toFixed(1);
                valueC.textContent = c.toFixed(1);

                // æ›´æ–°æ–¹ç¨‹æ˜¾ç¤º
                updateEquationDisplay(a, b, c);

                // é‡ç»˜å›¾åƒ
                drawDynamicFunction(a, b, c);

                // æ›´æ–°ä¿¡æ¯é¢æ¿
                updateInfoPanels(a, b, c);
            }

            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            coeffA.addEventListener('input', updateFunction);
            coeffB.addEventListener('input', updateFunction);
            coeffC.addEventListener('input', updateFunction);

            // é¢„è®¾æ–¹ç¨‹æŒ‰é’®
            document.querySelectorAll('.preset-equation').forEach(btn => {
                btn.addEventListener('click', function () {
                    const a = parseFloat(this.dataset.a);
                    const b = parseFloat(this.dataset.b);
                    const c = parseFloat(this.dataset.c);

                    coeffA.value = a;
                    coeffB.value = b;
                    coeffC.value = c;

                    updateFunction();
                });
            });
        }

        // æ›´æ–°æ–¹ç¨‹æ˜¾ç¤º
        function updateEquationDisplay(a, b, c) {
            const equation = document.getElementById('currentEquation');
            if (!equation) return;

            let equationText = 'y = ';

            if (a !== 1) {
                equationText += a === -1 ? '-' : a.toFixed(1);
            }
            equationText += 'xÂ²';

            if (b !== 0) {
                equationText += b > 0 ? ' + ' : ' - ';
                equationText += Math.abs(b) === 1 ? '' : Math.abs(b).toFixed(1);
                equationText += 'x';
            }

            if (c !== 0) {
                equationText += c > 0 ? ' + ' : ' - ';
                equationText += Math.abs(c).toFixed(1);
            }

            equation.textContent = equationText;
        }

        // ç»˜åˆ¶åŠ¨æ€å‡½æ•°å›¾åƒ
        function drawDynamicFunction(a, b, c) {
            const canvas = document.getElementById('mainFunctionGraph');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;

            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = 'rgba(15, 23, 42, 0.9)';
            ctx.fillRect(0, 0, width, height);

            // ç»˜åˆ¶ç½‘æ ¼
            ctx.strokeStyle = 'rgba(71, 85, 105, 0.3)';
            ctx.lineWidth = 0.5;

            const gridSize = 20;
            for (let x = 0; x <= width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }

            for (let y = 0; y <= height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }

            // ç»˜åˆ¶åæ ‡è½´
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;

            const centerX = width / 2;
            const centerY = height / 2;

            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(width, centerY);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, height);
            ctx.stroke();

            // ç»˜åˆ¶æŠ›ç‰©çº¿
            ctx.strokeStyle = '#0ea5e9';
            ctx.lineWidth = 3;
            ctx.beginPath();

            let firstPoint = true;
            const scale = 15;

            for (let x = -15; x <= 15; x += 0.1) {
                const y = a * x * x + b * x + c;
                const canvasX = centerX + x * scale;
                const canvasY = centerY - y * scale;

                if (canvasY >= 0 && canvasY <= height && canvasX >= 0 && canvasX <= width) {
                    if (firstPoint) {
                        ctx.moveTo(canvasX, canvasY);
                        firstPoint = false;
                    } else {
                        ctx.lineTo(canvasX, canvasY);
                    }
                }
            }
            ctx.stroke();

            // æ·»åŠ å‘å…‰æ•ˆæœ
            ctx.shadowColor = '#0ea5e9';
            ctx.shadowBlur = 10;
            ctx.stroke();
            ctx.shadowBlur = 0;

            // ç»˜åˆ¶æ ¹ç‚¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            const discriminant = b * b - 4 * a * c;
            if (discriminant >= 0) {
                const x1 = (-b + Math.sqrt(discriminant)) / (2 * a);
                const x2 = (-b - Math.sqrt(discriminant)) / (2 * a);

                ctx.fillStyle = '#f59e0b';

                if (Math.abs(x1) <= 15) {
                    const canvasX1 = centerX + x1 * scale;
                    ctx.beginPath();
                    ctx.arc(canvasX1, centerY, 4, 0, 2 * Math.PI);
                    ctx.fill();
                }

                if (Math.abs(x2) <= 15 && x1 !== x2) {
                    const canvasX2 = centerX + x2 * scale;
                    ctx.beginPath();
                    ctx.arc(canvasX2, centerY, 4, 0, 2 * Math.PI);
                    ctx.fill();
                }
            }

            // ç»˜åˆ¶é¡¶ç‚¹
            const vertexX = -b / (2 * a);
            const vertexY = a * vertexX * vertexX + b * vertexX + c;

            if (Math.abs(vertexX) <= 15 && Math.abs(vertexY) <= 15) {
                const canvasVertexX = centerX + vertexX * scale;
                const canvasVertexY = centerY - vertexY * scale;

                ctx.fillStyle = '#ec4899';
                ctx.beginPath();
                ctx.arc(canvasVertexX, canvasVertexY, 5, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        // æ›´æ–°ä¿¡æ¯é¢æ¿
        function updateInfoPanels(a, b, c) {
            const discriminant = b * b - 4 * a * c;
            const vertexX = -b / (2 * a);
            const vertexY = a * vertexX * vertexX + b * vertexX + c;

            // æ›´æ–°é¡¶ç‚¹ä¿¡æ¯
            const vertexInfo = document.getElementById('vertexInfo');
            if (vertexInfo) {
                vertexInfo.textContent = `(${vertexX.toFixed(2)}, ${vertexY.toFixed(2)})`;
            }

            // æ›´æ–°åˆ¤åˆ«å¼ä¿¡æ¯
            const discriminantInfo = document.getElementById('discriminantInfo');
            if (discriminantInfo) {
                discriminantInfo.textContent = discriminant.toFixed(2);
            }

            // æ›´æ–°å¼€å£æ–¹å‘
            const directionInfo = document.getElementById('directionInfo');
            if (directionInfo) {
                directionInfo.textContent = a > 0 ? 'å‘ä¸Š' : 'å‘ä¸‹';
            }

            // æ›´æ–°æ ¹çš„ä¿¡æ¯
            const rootsInfo = document.getElementById('rootsInfo');
            if (rootsInfo) {
                if (discriminant > 0) {
                    const x1 = (-b + Math.sqrt(discriminant)) / (2 * a);
                    const x2 = (-b - Math.sqrt(discriminant)) / (2 * a);
                    rootsInfo.textContent = `xâ‚ = ${x1.toFixed(2)}, xâ‚‚ = ${x2.toFixed(2)}`;
                } else if (discriminant === 0) {
                    const x = -b / (2 * a);
                    rootsInfo.textContent = `x = ${x.toFixed(2)} (é‡æ ¹)`;
                } else {
                    rootsInfo.textContent = 'æ— å®æ•°æ ¹';
                }
            }
        }

        // åˆå§‹åŒ–ç»ƒä¹ ç³»ç»Ÿ
        function initPracticeSystem() {
            document.querySelectorAll('.check-answer').forEach(btn => {
                btn.addEventListener('click', function () {
                    const input = this.parentElement.querySelector('.practice-input');
                    const feedback = this.parentElement.parentElement.querySelector('.answer-feedback');

                    if (!input || !feedback) return;

                    const userAnswer = parseFloat(input.value);
                    let correctAnswer, isCorrect;

                    // æ ¹æ®ç»ƒä¹ ç±»å‹åˆ¤æ–­æ­£ç¡®ç­”æ¡ˆ
                    const practiceTitle = this.closest('.card-3d').querySelector('h3').textContent;

                    if (practiceTitle.includes('å¤ªç©ºç«™æ‰©å»º')) {
                        correctAnswer = 5; // (20+x)(15+x) = 500 çš„è§£
                        isCorrect = Math.abs(userAnswer - correctAnswer) < 0.1;
                    } else if (practiceTitle.includes('è¡Œæ˜Ÿæ¢æµ‹å™¨')) {
                        correctAnswer = 51.2; // 5 Ã— (3.2)Â² = 51.2
                        isCorrect = Math.abs(userAnswer - correctAnswer) < 0.1;
                    }

                    feedback.classList.remove('hidden');

                    if (isCorrect) {
                        feedback.className = 'answer-feedback p-3 rounded-lg bg-green-500/20 border border-green-500/50 text-green-300';
                        feedback.textContent = 'ğŸ‰ æ­£ç¡®ï¼å¤ªæ£’äº†ï¼';
                    } else {
                        feedback.className = 'answer-feedback p-3 rounded-lg bg-red-500/20 border border-red-500/50 text-red-300';
                        feedback.textContent = `âŒ ä¸æ­£ç¡®ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯ ${correctAnswer}`;
                    }
                });
            });
        }

        // åˆå§‹åŒ–åŠ¨ç”»æ•ˆæœ
        function initAnimations() {
            // å¼€å§‹æ¸¸æˆæŒ‰é’®åŠ¨ç”»
            const startBtn = document.getElementById('startGameBtn');
            if (startBtn) {
                startBtn.addEventListener('click', function () {
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                        showGameLaunchModal();
                    }, 150);
                });
            }
            // æ˜¾ç¤ºæ¸¸æˆå¯åŠ¨æ¨¡æ€æ¡†
            function showGameLaunchModal() {
                // åˆ›å»ºæ¨¡æ€æ¡†èƒŒæ™¯
                const modalOverlay = document.createElement('div');
                modalOverlay.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 animate-fade-in';
                modalOverlay.style.animation = 'fadeIn 0.3s ease-out';

                // åˆ›å»ºæ¨¡æ€æ¡†å†…å®¹
                const modalContent = document.createElement('div');
                modalContent.className = 'glass-effect rounded-2xl p-8 max-w-md mx-4 text-center transform animate-zoom-in';
                modalContent.style.animation = 'zoomIn 0.4s ease-out';

                modalContent.innerHTML = `
                <div class="mb-6">
                    <div class="text-6xl mb-4 animate-float">ğŸš€</div>
                    <h2 class="text-3xl font-bold mb-4 font-space text-primary">å¤ªç©ºä»»åŠ¡å¯åŠ¨</h2>
                    <p class="text-lg text-space-300 mb-6">
                        å‡†å¤‡å¥½æ¢ç´¢æ•°å­¦å®‡å®™äº†å—ï¼Ÿ<br>
                        åœ¨è¿™ä¸ªå¤ªç©ºå†’é™©ä¸­ï¼Œä½ å°†ï¼š
                    </p>
                </div>
                
                <div class="space-y-3 mb-8 text-left">
                    <div class="flex items-center">
                        <span class="w-2 h-2 bg-primary rounded-full mr-3"></span>
                        <span>è§£å†³ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹æŒ‘æˆ˜</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-2 h-2 bg-secondary rounded-full mr-3"></span>
                        <span>æ”¶é›†å¤ªç©ºèƒ½é‡æ°´æ™¶</span>
                    </div>
                    <div class="flex items-center">
                        <span class="w-2 h-2 bg-accent rounded-full mr-3"></span>
                        <span>æ¢ç´¢ç¥ç§˜çš„æ•°å­¦æ˜Ÿç³»</span>
                    </div>
                </div>
                
                <div class="flex gap-4">
                    <button id="startMissionBtn" class="flex-1 bg-gradient-to-r from-primary to-secondary px-6 py-3 rounded-full font-space font-bold hover:scale-105 transition-all duration-300 shadow-lg">
                        <i class="fa fa-rocket mr-2"></i>
                        å¼€å§‹ä»»åŠ¡
                    </button>
                    <button id="cancelMissionBtn" class="flex-1 bg-gray-600 hover:bg-gray-700 px-6 py-3 rounded-full font-space font-bold hover:scale-105 transition-all duration-300">
                        <i class="fa fa-times mr-2"></i>
                        å–æ¶ˆ
                    </button>
                </div>
            `;

                modalOverlay.appendChild(modalContent);
                document.body.appendChild(modalOverlay);

                // æ·»åŠ CSSåŠ¨ç”»
                const style = document.createElement('style');
                style.textContent = `
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes zoomIn {
                    from { 
                        opacity: 0; 
                        transform: scale(0.8) translateY(20px); 
                    }
                    to { 
                        opacity: 1; 
                        transform: scale(1) translateY(0); 
                    }
                }
            `;
                document.head.appendChild(style);

                // ç»‘å®šäº‹ä»¶
                document.getElementById('startMissionBtn').addEventListener('click', function () {
                    // å¯åŠ¨æ¸¸æˆé€»è¾‘
                    launchSpaceGame();
                    closeModal();
                });

                document.getElementById('cancelMissionBtn').addEventListener('click', closeModal);
                modalOverlay.addEventListener('click', function (e) {
                    if (e.target === modalOverlay) closeModal();
                });

                function closeModal() {
                    modalOverlay.style.animation = 'fadeOut 0.3s ease-out';
                    setTimeout(() => {
                        document.body.removeChild(modalOverlay);
                        document.head.removeChild(style);
                    }, 300);
                }
            }

            // å¯åŠ¨å¤ªç©ºæ¸¸æˆ
            function launchSpaceGame() {
                // åˆ›å»ºæ¸¸æˆç•Œé¢
                const gameContainer = document.createElement('div');
                gameContainer.id = 'spaceGameContainer';
                gameContainer.className = 'fixed inset-0 bg-gradient-to-b from-indigo-900 via-purple-900 to-black z-40 overflow-hidden';

                gameContainer.innerHTML = `
                <div class="relative w-full h-full">
                    <!-- æ¸¸æˆç”»å¸ƒ -->
                    <canvas id="gameCanvas" class="absolute inset-0 w-full h-full"></canvas>
                    
                    <!-- æ¸¸æˆUIè¦†ç›–å±‚ -->
                    <div class="absolute inset-0 pointer-events-none">
                        <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
                        <div class="flex justify-between items-center p-4 glass-effect m-4 rounded-xl pointer-events-auto">
                            <div class="flex items-center space-x-6">
                                <div class="flex items-center">
                                    <i class="fa fa-heart text-red-500 mr-2"></i>
                                    <span id="gameHealth" class="font-space text-xl">100</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fa fa-star text-yellow-500 mr-2"></i>
                                    <span id="gameScore" class="font-space text-xl">0</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fa fa-clock text-blue-500 mr-2"></i>
                                    <span id="gameTime" class="font-space text-xl">05:00</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fa fa-layer-group text-green-500 mr-2"></i>
                                    <span id="gameLevel" class="font-space text-xl">1</span>
                                </div>
                            </div>
                            <button id="exitGameBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-full font-space transition-colors pointer-events-auto">
                                <i class="fa fa-times mr-2"></i>é€€å‡º
                            </button>
                        </div>
                        
                        <!-- é¢˜ç›®æ˜¾ç¤ºåŒºåŸŸ -->
                        <div id="questionPanel" class="absolute bottom-4 left-4 right-4 glass-effect p-6 rounded-xl pointer-events-auto transform translate-y-full transition-transform duration-500">
                            <h3 class="text-xl font-bold mb-4 font-space text-primary">æ•°å­¦æŒ‘æˆ˜</h3>
                            <div id="gameQuestion" class="text-lg mb-4 font-space text-center">
                                å‡†å¤‡æ¥å—æŒ‘æˆ˜...
                            </div>
                            <div id="answerOptions" class="grid grid-cols-2 gap-3">
                                <!-- ç­”æ¡ˆé€‰é¡¹å°†åŠ¨æ€ç”Ÿæˆ -->
                            </div>
                            <div id="questionTimer" class="mt-4 text-center">
                                <div class="w-full bg-gray-700 rounded-full h-2">
                                    <div id="timerBar" class="bg-gradient-to-r from-green-500 to-red-500 h-2 rounded-full transition-all duration-1000" style="width: 100%"></div>
                                </div>
                                <span class="text-sm text-gray-300 mt-1 block">å‰©ä½™æ—¶é—´</span>
                            </div>
                        </div>
                        
                        <!-- æ¸¸æˆæç¤º -->
                        <div id="gameHints" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none">
                            <div class="text-2xl font-space text-white opacity-80 animate-pulse">
                                ä½¿ç”¨é¼ æ ‡æ§åˆ¶é£èˆ¹ç§»åŠ¨
                            </div>
                            <div class="text-lg font-space text-gray-300 mt-2">
                                æ­£ç¡®ç­”é¢˜è·å¾—å¼ºåŠ›æ­¦å™¨ï¼
                            </div>
                        </div>
                    </div>
                </div>
            `;

                document.body.appendChild(gameContainer);

                // åˆå§‹åŒ–æ¸¸æˆ
                initThunderFighterGame();
            }

            // åˆå§‹åŒ–å¤ªç©ºæ¸¸æˆ
            // é›·éœ†æˆ˜æœºé£æ ¼çš„å¤ªç©ºæ¸¸æˆå¼•æ“
            function initThunderFighterGame() {
                const canvas = document.getElementById('gameCanvas');
                const ctx = canvas.getContext('2d');

                // è®¾ç½®canvaså°ºå¯¸
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;

                // æ¸¸æˆçŠ¶æ€
                const gameState = {
                    player: { x: canvas.width / 2, y: canvas.height - 100, width: 60, height: 60, health: 100 },
                    enemies: [],
                    bullets: [],
                    enemyBullets: [], // æ•Œæœºå­å¼¹
                    particles: [],
                    powerUps: [],
                    score: 0,
                    level: 1,
                    gameTime: 300, // 5åˆ†é’Ÿ
                    isRunning: true,
                    currentQuestion: null,
                    questionActive: false,
                    questionTimer: 15,
                    mouseX: canvas.width / 2,
                    mouseY: canvas.height - 100,
                    keys: {},
                    lastShot: 0,
                    shootCooldown: 200,
                    enemySpawnRate: 2000,
                    lastEnemySpawn: 0,
                    shieldActive: false, // æŠ¤ç›¾çŠ¶æ€
                    shieldTime: 0, // æŠ¤ç›¾å‰©ä½™æ—¶é—´
                    // æŒç»­é“å…·ç³»ç»Ÿ
                    persistentItems: {
                        weaponLevel: 1, // æ­¦å™¨ç­‰çº§ 1-5
                        shieldLevel: 0, // æŠ¤ç›¾ç­‰çº§ 0-3
                        speedLevel: 0, // é€Ÿåº¦ç­‰çº§ 0-3
                        healthLevel: 0, // ç”Ÿå‘½ç­‰çº§ 0-3
                        fireRateLevel: 0, // å°„é€Ÿç­‰çº§ 0-3
                        multiShotLevel: 0, // å¤šé‡å°„å‡»ç­‰çº§ 0-3
                        laserLevel: 0, // æ¿€å…‰ç­‰çº§ 0-3
                        bombLevel: 0 // ç‚¸å¼¹ç­‰çº§ 0-3
                    },
                    // è‡ªåŠ¨é©¾é©¶çŠ¶æ€
                    autopilot: {
                        active: false,
                        targetX: canvas.width / 2,
                        lastDirectionChange: 0,
                        avoidanceMode: false
                    }
                };

                // å®Œæ•´çš„æ•°å­¦é¢˜ç›®åº“
                const mathQuestions = [
                    // ä¸€èˆ¬å½¢å¼è½¬æ¢é¢˜ç›® - ç»ƒä¹ é¢˜
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ 5xÂ² - 1 = 4x åŒ–ä¸ºä¸€èˆ¬å½¢å¼ï¼Œå¹¶å†™å‡ºäºŒæ¬¡é¡¹ç³»æ•°',
                        options: ['5xÂ² - 4x - 1 = 0ï¼ŒäºŒæ¬¡é¡¹ç³»æ•°ä¸º5', '5xÂ² + 4x - 1 = 0ï¼ŒäºŒæ¬¡é¡¹ç³»æ•°ä¸º5', '5xÂ² - 4x + 1 = 0ï¼ŒäºŒæ¬¡é¡¹ç³»æ•°ä¸º5', 'xÂ² - 4x - 1 = 0ï¼ŒäºŒæ¬¡é¡¹ç³»æ•°ä¸º1'],
                        correct: 0,
                        difficulty: 1,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ 4xÂ² = 81 åŒ–ä¸ºä¸€èˆ¬å½¢å¼ï¼Œå¹¶å†™å‡ºå¸¸æ•°é¡¹',
                        options: ['4xÂ² - 81 = 0ï¼Œå¸¸æ•°é¡¹ä¸º-81', '4xÂ² + 81 = 0ï¼Œå¸¸æ•°é¡¹ä¸º81', 'xÂ² - 81 = 0ï¼Œå¸¸æ•°é¡¹ä¸º-81', '4xÂ² = 81ï¼Œæ— å¸¸æ•°é¡¹'],
                        correct: 0,
                        difficulty: 1,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ 4x(x+2) = 25 åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['4xÂ² + 8x - 25 = 0', '4xÂ² + 8x + 25 = 0', '4xÂ² - 8x - 25 = 0', 'xÂ² + 2x - 25 = 0'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ (3x-2)(x+1) = 8x-3 åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['3xÂ² - 7x + 1 = 0', '3xÂ² + 7x - 1 = 0', '3xÂ² - 7x - 1 = 0', '3xÂ² + x - 1 = 0'],
                        correct: 0,
                        difficulty: 3,
                        battleMode: 'rapid_fire'
                    },

                    // ä¹ é¢˜21.1 - ä¸€èˆ¬å½¢å¼è½¬æ¢
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ 3xÂ² + 1 = 6x åŒ–ä¸ºä¸€èˆ¬å½¢å¼ï¼Œå¹¶å†™å‡ºä¸€æ¬¡é¡¹ç³»æ•°',
                        options: ['3xÂ² - 6x + 1 = 0ï¼Œä¸€æ¬¡é¡¹ç³»æ•°ä¸º-6', '3xÂ² + 6x + 1 = 0ï¼Œä¸€æ¬¡é¡¹ç³»æ•°ä¸º6', '3xÂ² - 6x - 1 = 0ï¼Œä¸€æ¬¡é¡¹ç³»æ•°ä¸º-6', 'xÂ² - 2x + 1 = 0ï¼Œä¸€æ¬¡é¡¹ç³»æ•°ä¸º-2'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ 4xÂ² + 5x = 81 åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['4xÂ² + 5x - 81 = 0', '4xÂ² + 5x + 81 = 0', '4xÂ² - 5x - 81 = 0', 'xÂ² + 5x - 81 = 0'],
                        correct: 0,
                        difficulty: 1,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ x(x+5) = 0 åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['xÂ² + 5x = 0', 'xÂ² - 5x = 0', 'xÂ² + 5x + 0 = 0', 'x + 5 = 0'],
                        correct: 0,
                        difficulty: 1,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ (2x-2)(x-1) = 0 åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['2xÂ² - 4x + 2 = 0', '2xÂ² + 4x - 2 = 0', '2xÂ² - 4x - 2 = 0', 'xÂ² - 2x + 1 = 0'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ x(x+5) = 5x-10 åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['xÂ² - 10 = 0', 'xÂ² + 5x - 10 = 0', 'xÂ² - 5x + 10 = 0', 'xÂ² + 10 = 0'],
                        correct: 0,
                        difficulty: 3,
                        battleMode: 'rapid_fire'
                    },
                    {
                        type: 'standard_form',
                        question: 'å°†æ–¹ç¨‹ (3x-2)(x+1) = x(2x-1) åŒ–ä¸ºä¸€èˆ¬å½¢å¼',
                        options: ['xÂ² - x - 2 = 0', 'xÂ² + x + 2 = 0', 'xÂ² - x + 2 = 0', 'xÂ² + x - 2 = 0'],
                        correct: 0,
                        difficulty: 3,
                        battleMode: 'rapid_fire'
                    },

                    // åº”ç”¨é¢˜ - ç»ƒä¹ é¢˜
                    {
                        type: 'application',
                        question: '4ä¸ªå®Œå…¨ç›¸åŒçš„æ­£æ–¹å½¢é¢ç§¯ä¹‹å’Œæ˜¯25ï¼Œæ±‚æ­£æ–¹å½¢è¾¹é•¿xçš„æ–¹ç¨‹',
                        options: ['4xÂ² = 25', 'xÂ² = 25', '4x = 25', '2xÂ² = 25'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'shield_mode'
                    },
                    {
                        type: 'application',
                        question: 'çŸ©å½¢é•¿æ¯”å®½å¤š2ï¼Œé¢ç§¯æ˜¯100ï¼Œæ±‚çŸ©å½¢é•¿xçš„æ–¹ç¨‹',
                        options: ['x(x-2) = 100', 'x(x+2) = 100', '2xÂ² = 100', 'xÂ² + 2x = 100'],
                        correct: 0,
                        difficulty: 3,
                        battleMode: 'shield_mode'
                    },
                    {
                        type: 'application',
                        question: 'æŠŠé•¿ä¸º1çš„æœ¨æ¡åˆ†æˆä¸¤æ®µï¼Œä½¿è¾ƒçŸ­ä¸€æ®µçš„é•¿ä¸å…¨é•¿çš„ç§¯ç­‰äºè¾ƒé•¿ä¸€æ®µçš„é•¿çš„å¹³æ–¹ï¼Œæ±‚è¾ƒçŸ­ä¸€æ®µçš„é•¿x',
                        options: ['xÂ·1 = (1-x)Â²', 'xÂ² = 1-x', 'x(1-x) = xÂ²', 'xÂ·1 = (1-x)Â²'],
                        correct: 0,
                        difficulty: 4,
                        battleMode: 'shield_mode'
                    },

                    // åº”ç”¨é¢˜ - ä¹ é¢˜21.1
                    {
                        type: 'application',
                        question: 'ä¸€ä¸ªåœ†çš„é¢ç§¯æ˜¯2Ï€ mÂ²ï¼Œæ±‚åŠå¾„rçš„æ–¹ç¨‹',
                        options: ['Ï€rÂ² = 2Ï€', '2Ï€r = 2Ï€', 'Ï€rÂ² = 2', 'rÂ² = 2Ï€'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'shield_mode'
                    },
                    {
                        type: 'application',
                        question: 'ç›´è§’ä¸‰è§’å½¢ä¸¤æ¡ç›´è§’è¾¹ç›¸å·®3cmï¼Œé¢ç§¯æ˜¯9cmÂ²ï¼Œæ±‚è¾ƒé•¿ç›´è§’è¾¹xçš„æ–¹ç¨‹',
                        options: ['x(x-3) = 18', 'Â½x(x-3) = 9', 'x(x+3) = 18', 'Â½x(x+3) = 9'],
                        correct: 1,
                        difficulty: 3,
                        battleMode: 'shield_mode'
                    },
                    {
                        type: 'application',
                        question: 'çŸ©å½¢é•¿æ¯”å®½å¤š1cmï¼Œé¢ç§¯æ˜¯132cmÂ²ï¼Œæ±‚é•¿xçš„æ–¹ç¨‹',
                        options: ['x(x-1) = 132', 'x(x+1) = 132', 'xÂ² + x = 132', 'xÂ² - x = 132'],
                        correct: 0,
                        difficulty: 3,
                        battleMode: 'shield_mode'
                    },
                    {
                        type: 'application',
                        question: 'ç”¨1mé•¿çš„é“ä¸å›´æˆé¢ç§¯ä¸º0.06mÂ²çš„çŸ©å½¢ï¼Œè®¾é•¿ä¸ºxï¼Œæ±‚æ–¹ç¨‹',
                        options: ['x(0.5-x) = 0.06', 'x(1-x) = 0.06', '2x(0.5-x) = 0.06', 'x(0.25-x) = 0.06'],
                        correct: 0,
                        difficulty: 4,
                        battleMode: 'shield_mode'
                    },
                    {
                        type: 'application',
                        question: 'èšä¼šä¸­æ¯ä¸¤äººéƒ½æ¡ä¸€æ¬¡æ‰‹ï¼Œå…±æ¡æ‰‹10æ¬¡ï¼Œæ±‚å‚åŠ äººæ•°xçš„æ–¹ç¨‹',
                        options: ['x(x-1)/2 = 10', 'x(x+1)/2 = 10', 'xÂ² = 10', '2x = 10'],
                        correct: 0,
                        difficulty: 4,
                        battleMode: 'shield_mode'
                    },

                    // æ ¹çš„åˆ¤æ–­é¢˜
                    {
                        type: 'roots',
                        question: 'ä¸‹åˆ—å“ªä¸ªæ•°æ˜¯æ–¹ç¨‹ xÂ² + x - 12 = 0 çš„æ ¹ï¼Ÿ',
                        options: ['3', '4', '2', '1'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'boss_fight'
                    },
                    {
                        type: 'roots',
                        question: 'åœ¨æ•°å­— -4, -3, -2, -1, 0, 1, 2, 3, 4 ä¸­ï¼Œå“ªä¸ªæ˜¯æ–¹ç¨‹ xÂ² + x - 12 = 0 çš„æ ¹ï¼Ÿ',
                        options: ['-4', '-3', '0', '4'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'boss_fight'
                    },
                    {
                        type: 'roots',
                        question: 'å¦‚æœ2æ˜¯æ–¹ç¨‹ xÂ² - c = 0 çš„ä¸€ä¸ªæ ¹ï¼Œé‚£ä¹ˆå¸¸æ•°cæ˜¯å¤šå°‘ï¼Ÿ',
                        options: ['4', '2', '-2', '-4'],
                        correct: 0,
                        difficulty: 3,
                        battleMode: 'boss_fight'
                    },
                    {
                        type: 'roots',
                        question: 'æ–¹ç¨‹ xÂ² - 4 = 0 çš„æ ¹æ˜¯ä»€ä¹ˆï¼Ÿ',
                        options: ['x = Â±2', 'x = Â±4', 'x = 2', 'x = 4'],
                        correct: 0,
                        difficulty: 2,
                        battleMode: 'boss_fight'
                    }
                ];

                // é¼ æ ‡æ§åˆ¶
                canvas.addEventListener('mousemove', (e) => {
                    const rect = canvas.getBoundingClientRect();
                    gameState.mouseX = e.clientX - rect.left;
                    gameState.mouseY = e.clientY - rect.top;
                });

                // é”®ç›˜æ§åˆ¶
                document.addEventListener('keydown', (e) => {
                    gameState.keys[e.key] = true;
                });

                document.addEventListener('keyup', (e) => {
                    gameState.keys[e.key] = false;
                });

                // åˆ›å»ºæ˜Ÿç©ºèƒŒæ™¯
                const stars = [];
                for (let i = 0; i < 300; i++) {
                    stars.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        size: Math.random() * 2 + 0.5,
                        speed: Math.random() * 2 + 0.5,
                        opacity: Math.random() * 0.8 + 0.2
                    });
                }

                // ç»˜åˆ¶æ˜Ÿç©º
                function drawStars() {
                    stars.forEach(star => {
                        ctx.save();
                        ctx.globalAlpha = star.opacity;
                        ctx.fillStyle = '#ffffff';
                        ctx.beginPath();
                        ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.restore();

                        star.y += star.speed;
                        if (star.y > canvas.height) {
                            star.y = -10;
                            star.x = Math.random() * canvas.width;
                        }
                    });
                }

                // ç»˜åˆ¶ç©å®¶é£èˆ¹
                function drawPlayer() {
                    const player = gameState.player;

                    // å¹³æ»‘ç§»åŠ¨åˆ°é¼ æ ‡ä½ç½®
                    const dx = gameState.mouseX - player.x;
                    const dy = gameState.mouseY - player.y;
                    player.x += dx * 0.1;
                    player.y += dy * 0.1;

                    // é™åˆ¶è¾¹ç•Œ
                    player.x = Math.max(30, Math.min(canvas.width - 30, player.x));
                    player.y = Math.max(30, Math.min(canvas.height - 30, player.y));

                    // ç»˜åˆ¶æŠ¤ç›¾æ•ˆæœ
                    if (gameState.shieldActive) {
                        ctx.save();
                        ctx.globalAlpha = 0.3 + Math.sin(Date.now() * 0.01) * 0.2;
                        ctx.strokeStyle = '#00ffff';
                        ctx.lineWidth = 3;
                        ctx.beginPath();
                        ctx.arc(player.x, player.y, 50, 0, Math.PI * 2);
                        ctx.stroke();

                        // æŠ¤ç›¾ç²’å­æ•ˆæœ
                        ctx.globalAlpha = 0.6;
                        for (let i = 0; i < 8; i++) {
                            const angle = (Date.now() * 0.005 + i * Math.PI / 4) % (Math.PI * 2);
                            const x = player.x + Math.cos(angle) * 45;
                            const y = player.y + Math.sin(angle) * 45;
                            ctx.fillStyle = '#00ffff';
                            ctx.beginPath();
                            ctx.arc(x, y, 3, 0, Math.PI * 2);
                            ctx.fill();
                        }
                        ctx.restore();
                    }

                    // ç»˜åˆ¶é£èˆ¹å°¾ç„°ç²’å­æ•ˆæœ
                    for (let i = 0; i < 5; i++) {
                        const offsetX = (Math.random() - 0.5) * 20;
                        const offsetY = 15 + Math.random() * 20;
                        const size = Math.random() * 4 + 2;

                        ctx.save();
                        ctx.globalAlpha = 0.7 - i * 0.1;
                        ctx.fillStyle = i % 2 === 0 ? '#ff6600' : '#ffaa00';
                        ctx.beginPath();
                        ctx.arc(player.x + offsetX, player.y + offsetY, size, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.restore();
                    }

                    // ç»˜åˆ¶é£èˆ¹
                    ctx.save();
                    ctx.translate(player.x, player.y);

                    // æ·»åŠ å‘å…‰æ•ˆæœ
                    ctx.shadowColor = '#00ffff';
                    ctx.shadowBlur = 15;

                    // é£èˆ¹ä¸»ä½“ - æ›´åä¸½çš„è®¾è®¡
                    const gradient = ctx.createLinearGradient(0, -25, 0, 15);
                    gradient.addColorStop(0, '#00ffff');
                    gradient.addColorStop(0.5, '#0088ff');
                    gradient.addColorStop(1, '#004488');
                    ctx.fillStyle = gradient;

                    // ä¸»ä½“å½¢çŠ¶
                    ctx.beginPath();
                    ctx.moveTo(0, -25);
                    ctx.lineTo(-15, 15);
                    ctx.lineTo(-8, 10);
                    ctx.lineTo(0, -5);
                    ctx.lineTo(8, 10);
                    ctx.lineTo(15, 15);
                    ctx.closePath();
                    ctx.fill();

                    // é£èˆ¹è£…é¥°çº¿æ¡
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    ctx.moveTo(-10, 0);
                    ctx.lineTo(10, 0);
                    ctx.moveTo(-8, -10);
                    ctx.lineTo(8, -10);
                    ctx.stroke();

                    // é©¾é©¶èˆ±
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.arc(0, -10, 6, 0, Math.PI * 2);
                    ctx.fill();

                    // é©¾é©¶èˆ±å†…éƒ¨
                    ctx.fillStyle = '#0066ff';
                    ctx.beginPath();
                    ctx.arc(0, -10, 4, 0, Math.PI * 2);
                    ctx.fill();

                    // æ­¦å™¨æŒ‚è½½ç‚¹
                    ctx.fillStyle = '#ff0000';
                    ctx.fillRect(-12, 5, 4, 8);
                    ctx.fillRect(8, 5, 4, 8);

                    // é£èˆ¹å¼•æ“å…‰æ•ˆ - æ›´åä¸½
                    const engineGradient = ctx.createLinearGradient(0, 10, 0, 25);
                    engineGradient.addColorStop(0, '#ff6600');
                    engineGradient.addColorStop(0.5, '#ffaa00');
                    engineGradient.addColorStop(1, '#ffff00');
                    ctx.fillStyle = engineGradient;

                    ctx.beginPath();
                    ctx.moveTo(-8, 10);
                    ctx.lineTo(-4, 25 + Math.sin(Date.now() * 0.01) * 3);
                    ctx.lineTo(0, 20 + Math.sin(Date.now() * 0.015) * 2);
                    ctx.lineTo(4, 25 + Math.sin(Date.now() * 0.01) * 3);
                    ctx.lineTo(8, 10);
                    ctx.closePath();
                    ctx.fill();

                    // ä¾§ç¿¼å¼•æ“
                    ctx.fillStyle = '#ff3300';
                    ctx.fillRect(-15, 12, 3, 8 + Math.sin(Date.now() * 0.02) * 2);
                    ctx.fillRect(12, 12, 3, 8 + Math.sin(Date.now() * 0.02) * 2);

                    // èƒ½é‡æ ¸å¿ƒå‘å…‰æ•ˆæœ
                    ctx.save();
                    ctx.globalAlpha = 0.8 + Math.sin(Date.now() * 0.008) * 0.2;
                    ctx.fillStyle = '#00ffff';
                    ctx.beginPath();
                    ctx.arc(0, 0, 3, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.restore();

                    ctx.restore();
                }

                // åˆ›å»ºå­å¼¹
                function createBullet(x, y, type = 'normal') {
                    const items = gameState.persistentItems;

                    // åŸºç¡€å­å¼¹
                    let bullet = {
                        x: x,
                        y: y,
                        width: 4,
                        height: 15,
                        speed: 8,
                        type: type,
                        damage: 1 + items.weaponLevel
                    };

                    // æ ¹æ®å­å¼¹ç±»å‹è®¾ç½®ä¸åŒå±æ€§
                    switch (type) {
                        case 'rapid':
                            bullet.speed = 12 + items.fireRateLevel * 2;
                            bullet.width = 3;
                            bullet.height = 10;
                            bullet.color = '#ffff00';
                            break;
                        case 'laser':
                            bullet.speed = 15 + items.laserLevel * 3;
                            bullet.width = 6 + items.laserLevel * 2;
                            bullet.height = 20 + items.laserLevel * 5;
                            bullet.damage = 3 + items.laserLevel * 2;
                            bullet.color = '#ff0000';
                            break;
                        case 'super':
                            bullet.speed = 10;
                            bullet.width = 8 + items.weaponLevel;
                            bullet.height = 25 + items.weaponLevel * 2;
                            bullet.damage = 5 + items.weaponLevel * 2;
                            bullet.color = '#ff00ff';
                            break;
                        default:
                            bullet.color = '#00ff00';
                    }

                    gameState.bullets.push(bullet);

                    // å¤šé‡å°„å‡»
                    if (items.multiShotLevel > 0) {
                        for (let i = 1; i <= items.multiShotLevel; i++) {
                            const sideBullet1 = { ...bullet };
                            const sideBullet2 = { ...bullet };
                            sideBullet1.x = x - i * 15;
                            sideBullet2.x = x + i * 15;
                            gameState.bullets.push(sideBullet1, sideBullet2);
                        }
                    }
                }

                // ç»˜åˆ¶å­å¼¹
                function drawBullets() {
                    gameState.bullets.forEach((bullet, index) => {
                        bullet.y -= bullet.speed;

                        // æ ¹æ®å­å¼¹ç±»å‹è®¾ç½®é¢œè‰²å’Œæ•ˆæœ
                        ctx.save();

                        if (bullet.type === 'laser') {
                            ctx.fillStyle = bullet.color || '#ff0080';
                            ctx.shadowColor = bullet.color || '#ff0080';
                            ctx.shadowBlur = 15;
                        } else if (bullet.type === 'super') {
                            ctx.fillStyle = bullet.color || '#ff00ff';
                            ctx.shadowColor = bullet.color || '#ff00ff';
                            ctx.shadowBlur = 20;
                            // æ·»åŠ ç²’å­å°¾è¿¹
                            for (let i = 0; i < 2; i++) {
                                gameState.particles.push({
                                    x: bullet.x + Math.random() * bullet.width,
                                    y: bullet.y + bullet.height,
                                    vx: (Math.random() - 0.5) * 3,
                                    vy: Math.random() * 2 + 1,
                                    life: 15,
                                    maxLife: 15,
                                    size: 2,
                                    color: bullet.color || '#ff00ff',
                                    type: 'trail'
                                });
                            }
                        } else if (bullet.type === 'rapid') {
                            ctx.fillStyle = bullet.color || '#ffff00';
                            ctx.shadowColor = bullet.color || '#ffff00';
                            ctx.shadowBlur = 8;
                        } else {
                            ctx.fillStyle = bullet.color || '#00ff00';
                            ctx.shadowColor = bullet.color || '#00ff00';
                            ctx.shadowBlur = 5;
                        }

                        ctx.fillRect(bullet.x - bullet.width / 2, bullet.y, bullet.width, bullet.height);
                        ctx.restore();

                        // ç§»é™¤è¶…å‡ºå±å¹•çš„å­å¼¹
                        if (bullet.y < -20) {
                            gameState.bullets.splice(index, 1);
                        }
                    });
                }

                // åˆ›å»ºæ•Œæœº
                function createEnemy(type = 'normal') {
                    let enemy;

                    switch (type) {
                        case 'scout':
                            enemy = {
                                x: Math.random() * (canvas.width - 40) + 20,
                                y: -30,
                                width: 25,
                                height: 25,
                                speed: Math.random() * 3 + 3, // å¿«é€Ÿ
                                health: 1,
                                maxHealth: 1,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 2000,
                                color: '#00ff88',
                                pattern: 'zigzag', // ä¹‹å­—å½¢ç§»åŠ¨
                                patternTimer: 0
                            };
                            break;
                        case 'heavy':
                            enemy = {
                                x: Math.random() * (canvas.width - 80) + 40,
                                y: -60,
                                width: 60,
                                height: 60,
                                speed: Math.random() * 1 + 0.5, // ç¼“æ…¢
                                health: 5,
                                maxHealth: 5,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 800,
                                color: '#8800ff',
                                pattern: 'straight', // ç›´çº¿ç§»åŠ¨
                                armor: true // æœ‰è£…ç”²
                            };
                            break;
                        case 'sniper':
                            enemy = {
                                x: Math.random() * (canvas.width - 50) + 25,
                                y: -40,
                                width: 35,
                                height: 35,
                                speed: Math.random() * 1.5 + 1,
                                health: 2,
                                maxHealth: 2,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 1200,
                                color: '#ff0088',
                                pattern: 'hover', // æ‚¬åœå°„å‡»
                                targetLocked: false
                            };
                            break;
                        case 'bomber':
                            enemy = {
                                x: Math.random() * (canvas.width - 70) + 35,
                                y: -50,
                                width: 50,
                                height: 50,
                                speed: Math.random() * 2 + 1.5,
                                health: 3,
                                maxHealth: 3,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 1000,
                                color: '#ffaa00',
                                pattern: 'dive', // ä¿¯å†²æ”»å‡»
                                bombLoad: 3
                            };
                            break;
                        case 'boss':
                            enemy = {
                                x: canvas.width / 2,
                                y: -80,
                                width: 80,
                                height: 80,
                                speed: Math.random() * 1 + 0.8,
                                health: 15,
                                maxHealth: 15,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 300,
                                color: '#ff0000',
                                pattern: 'boss_pattern',
                                phase: 1,
                                specialAttackTimer: 0
                            };
                            break;
                        case 'strong':
                            enemy = {
                                x: Math.random() * (canvas.width - 60) + 30,
                                y: -50,
                                width: 45,
                                height: 45,
                                speed: Math.random() * 2 + 1.5,
                                health: 3,
                                maxHealth: 3,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 1000,
                                color: '#ff8800',
                                pattern: 'aggressive'
                            };
                            break;
                        default: // normal
                            enemy = {
                                x: Math.random() * (canvas.width - 60) + 30,
                                y: -50,
                                width: 40,
                                height: 40,
                                speed: Math.random() * 2 + 1,
                                health: 1,
                                maxHealth: 1,
                                type: type,
                                lastShot: 0,
                                shootCooldown: 1500,
                                color: '#ff4444',
                                pattern: 'straight'
                            };
                    }

                    gameState.enemies.push(enemy);
                }

                // æ›´æ–°æ•Œæœºç§»åŠ¨æ¨¡å¼
                function updateEnemyMovement(enemy) {
                    if (!enemy.moveTimer) enemy.moveTimer = 0;
                    enemy.moveTimer++;

                    switch (enemy.pattern) {
                        case 'zigzag':
                            enemy.x += Math.sin(enemy.moveTimer * 0.1) * 3;
                            break;
                        case 'straight':
                            // ç›´çº¿ç§»åŠ¨ï¼Œæ— é¢å¤–æ“ä½œ
                            break;
                        case 'hover':
                            enemy.y += Math.sin(enemy.moveTimer * 0.05) * 2;
                            enemy.x += Math.cos(enemy.moveTimer * 0.03) * 1.5;
                            break;
                        case 'dive':
                            if (enemy.moveTimer % 120 === 0) {
                                enemy.speed = enemy.speed === enemy.originalSpeed ? enemy.originalSpeed * 3 : enemy.originalSpeed;
                            }
                            break;
                        case 'boss_pattern':
                            if (enemy.moveTimer % 180 === 0) {
                                enemy.targetX = Math.random() * (canvas.width - 60) + 30;
                            }
                            if (enemy.targetX) {
                                const dx = enemy.targetX - enemy.x;
                                enemy.x += dx * 0.02;
                            }
                            break;
                        case 'aggressive':
                            const playerDx = gameState.player.x - enemy.x;
                            enemy.x += Math.sign(playerDx) * 1.5;
                            break;
                    }

                    // è¾¹ç•Œæ£€æŸ¥
                    if (enemy.x < 0) enemy.x = 0;
                    if (enemy.x > canvas.width) enemy.x = canvas.width;
                }

                // ç»˜åˆ¶æ•Œæœº
                function drawEnemies() {
                    gameState.enemies.forEach((enemy, index) => {
                        // æ›´æ–°æ•Œæœºç§»åŠ¨æ¨¡å¼
                        updateEnemyMovement(enemy);

                        enemy.y += enemy.speed;

                        // æ•Œæœºé¢œè‰²æ ¹æ®ç±»å‹
                        ctx.fillStyle = enemy.color || '#ff4444';

                        // ç»˜åˆ¶ä¸åŒå½¢çŠ¶çš„æ•Œæœº
                        ctx.save();
                        ctx.translate(enemy.x, enemy.y);

                        // æ·»åŠ å‘å…‰æ•ˆæœ
                        ctx.shadowColor = enemy.color || '#ff4444';
                        ctx.shadowBlur = 10;

                        switch (enemy.type) {
                            case 'scout':
                                // å°å‹ä¸‰è§’å½¢
                                ctx.beginPath();
                                ctx.moveTo(0, 10);
                                ctx.lineTo(-8, -8);
                                ctx.lineTo(8, -8);
                                ctx.closePath();
                                ctx.fill();
                                break;
                            case 'heavy':
                                // å¤§å‹å…­è¾¹å½¢
                                ctx.beginPath();
                                for (let i = 0; i < 6; i++) {
                                    const angle = (i * Math.PI) / 3;
                                    const x = Math.cos(angle) * 20;
                                    const y = Math.sin(angle) * 20;
                                    if (i === 0) ctx.moveTo(x, y);
                                    else ctx.lineTo(x, y);
                                }
                                ctx.closePath();
                                ctx.fill();
                                // è£…ç”²æ•ˆæœ
                                if (enemy.armor) {
                                    ctx.strokeStyle = '#ffffff';
                                    ctx.lineWidth = 2;
                                    ctx.stroke();
                                }
                                break;
                            case 'sniper':
                                // ç»†é•¿å½¢çŠ¶
                                ctx.fillRect(-5, -15, 10, 30);
                                ctx.fillRect(-15, -5, 30, 10);
                                // ç„å‡†çº¿
                                if (enemy.targetLocked) {
                                    ctx.strokeStyle = '#ff0088';
                                    ctx.lineWidth = 2;
                                    ctx.beginPath();
                                    ctx.moveTo(0, 15);
                                    ctx.lineTo(gameState.player.x - enemy.x, gameState.player.y - enemy.y);
                                    ctx.stroke();
                                }
                                break;
                            case 'bomber':
                                // å®½å¤§å½¢çŠ¶
                                ctx.beginPath();
                                ctx.ellipse(0, 0, 25, 15, 0, 0, 2 * Math.PI);
                                ctx.fill();
                                // ç‚¸å¼¹æŒ‡ç¤ºå™¨
                                for (let i = 0; i < enemy.bombLoad; i++) {
                                    ctx.fillStyle = '#ff0000';
                                    ctx.fillRect(-20 + i * 15, 10, 8, 8);
                                }
                                break;
                            case 'boss':
                                // å¤æ‚Bosså½¢çŠ¶
                                ctx.beginPath();
                                ctx.moveTo(0, 25);
                                ctx.lineTo(-30, -15);
                                ctx.lineTo(-15, -25);
                                ctx.lineTo(0, -10);
                                ctx.lineTo(15, -25);
                                ctx.lineTo(30, -15);
                                ctx.closePath();
                                ctx.fill();

                                // Bossç‰¹æ•ˆ
                                ctx.strokeStyle = '#ffff00';
                                ctx.lineWidth = 3;
                                ctx.stroke();

                                // ç›¸ä½æŒ‡ç¤ºå™¨
                                for (let i = 0; i < enemy.phase; i++) {
                                    ctx.fillStyle = '#ffff00';
                                    ctx.fillRect(-35 + i * 15, -35, 10, 5);
                                }
                                break;
                            default:
                                // æ ‡å‡†æ•Œæœºå½¢çŠ¶
                                ctx.beginPath();
                                ctx.moveTo(0, 15);
                                ctx.lineTo(-12, -10);
                                ctx.lineTo(-6, -15);
                                ctx.lineTo(0, -5);
                                ctx.lineTo(6, -15);
                                ctx.lineTo(12, -10);
                                ctx.closePath();
                                ctx.fill();
                        }

                        ctx.restore();

                        // è¡€æ¡
                        if (enemy.health < enemy.maxHealth) {
                            const barWidth = enemy.width;
                            const barHeight = 4;
                            const healthPercent = enemy.health / enemy.maxHealth;

                            ctx.fillStyle = '#333';
                            ctx.fillRect(enemy.x - barWidth / 2, enemy.y - 25, barWidth, barHeight);
                            ctx.fillStyle = healthPercent > 0.5 ? '#00ff00' : (healthPercent > 0.2 ? '#ffff00' : '#ff0000');
                            ctx.fillRect(enemy.x - barWidth / 2, enemy.y - 25, barWidth * healthPercent, barHeight);
                        }

                        // æ•Œæœºå°„å‡»
                        const now = Date.now();
                        if (now - enemy.lastShot > enemy.shootCooldown) {
                            createEnemyBullet(enemy.x, enemy.y + 20);
                            enemy.lastShot = now;
                        }

                        // ç§»é™¤è¶…å‡ºå±å¹•çš„æ•Œæœº
                        if (enemy.y > canvas.height + 50) {
                            gameState.enemies.splice(index, 1);
                        }
                    });
                }

                // åˆ›å»ºæ•Œæœºå­å¼¹
                function createEnemyBullet(x, y) {
                    const bullet = {
                        x: x,
                        y: y,
                        width: 3,
                        height: 10,
                        speed: 4,
                        isEnemy: true
                    };
                    gameState.bullets.push(bullet);
                }

                // ç¢°æ’æ£€æµ‹
                function checkCollisions() {
                    // ç©å®¶å­å¼¹ä¸æ•Œæœºç¢°æ’
                    gameState.bullets.forEach((bullet, bulletIndex) => {
                        if (bullet.isEnemy) return;

                        gameState.enemies.forEach((enemy, enemyIndex) => {
                            if (bullet.x > enemy.x - enemy.width / 2 &&
                                bullet.x < enemy.x + enemy.width / 2 &&
                                bullet.y > enemy.y - enemy.height / 2 &&
                                bullet.y < enemy.y + enemy.height / 2) {

                                // æ ¹æ®æ•Œæœºç±»å‹åˆ›å»ºä¸åŒå¤§å°çš„çˆ†ç‚¸
                                const explosionSize = enemy.type === 'boss' ? 'large' :
                                    enemy.type === 'strong' ? 'normal' : 'small';
                                createExplosion(enemy.x, enemy.y, explosionSize);

                                // å‡å°‘æ•Œæœºè¡€é‡
                                enemy.health -= bullet.damage;
                                gameState.bullets.splice(bulletIndex, 1);

                                if (enemy.health <= 0) {
                                    gameState.score += enemy.type === 'boss' ? 50 : (enemy.type === 'strong' ? 20 : 10);
                                    gameState.enemies.splice(enemyIndex, 1);
                                    updateUI();
                                }
                            }
                        });
                    });

                    // æ•Œæœºå­å¼¹ä¸ç©å®¶ç¢°æ’
                    gameState.bullets.forEach((bullet, bulletIndex) => {
                        if (!bullet.isEnemy) return;

                        const player = gameState.player;
                        if (bullet.x > player.x - player.width / 2 &&
                            bullet.x < player.x + player.width / 2 &&
                            bullet.y > player.y - player.height / 2 &&
                            bullet.y < player.y + player.height / 2) {

                            // å¦‚æœæœ‰æŠ¤ç›¾ï¼Œå‡å°‘ä¼¤å®³
                            const damage = gameState.shieldActive ? 5 : 10;
                            player.health -= damage;
                            gameState.bullets.splice(bulletIndex, 1);
                            createExplosion(player.x, player.y, 'small');
                            updateUI();

                            if (player.health <= 0) {
                                endGame();
                            }
                        }
                    });

                    // æ•Œæœºä¸ç©å®¶ç¢°æ’
                    gameState.enemies.forEach((enemy, enemyIndex) => {
                        const player = gameState.player;
                        if (Math.abs(enemy.x - player.x) < 30 && Math.abs(enemy.y - player.y) < 30) {
                            // å¦‚æœæœ‰æŠ¤ç›¾ï¼Œå‡å°‘ä¼¤å®³
                            const damage = gameState.shieldActive ? 10 : 20;
                            player.health -= damage;
                            gameState.enemies.splice(enemyIndex, 1);
                            createExplosion(enemy.x, enemy.y, 'normal');
                            updateUI();

                            if (player.health <= 0) {
                                endGame();
                            }
                        }
                    });
                }

                // æ»šåŠ¨èƒŒæ™¯
                let backgroundOffset = 0;
                function drawScrollingBackground() {
                    // æ¸…ç©ºç”»å¸ƒ
                    ctx.fillStyle = 'rgba(0, 0, 20, 0.1)';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    // ç»˜åˆ¶ç½‘æ ¼èƒŒæ™¯
                    ctx.strokeStyle = 'rgba(14, 165, 233, 0.1)';
                    ctx.lineWidth = 1;

                    const gridSize = 40;
                    backgroundOffset += 0.5; // æ»šåŠ¨é€Ÿåº¦
                    if (backgroundOffset >= gridSize) backgroundOffset = 0;

                    // å‚ç›´çº¿
                    for (let x = -backgroundOffset; x < canvas.width + gridSize; x += gridSize) {
                        ctx.beginPath();
                        ctx.moveTo(x, 0);
                        ctx.lineTo(x, canvas.height);
                        ctx.stroke();
                    }

                    // æ°´å¹³çº¿
                    for (let y = -backgroundOffset; y < canvas.height + gridSize; y += gridSize) {
                        ctx.beginPath();
                        ctx.moveTo(0, y);
                        ctx.lineTo(canvas.width, y);
                        ctx.stroke();
                    }

                    // æ·»åŠ ä¸€äº›åŠ¨æ€å…‰ç‚¹
                    ctx.fillStyle = 'rgba(14, 165, 233, 0.3)';
                    for (let i = 0; i < 5; i++) {
                        const x = (Date.now() * 0.01 + i * 200) % (canvas.width + 100) - 50;
                        const y = (Date.now() * 0.005 + i * 150) % (canvas.height + 100) - 50;
                        ctx.beginPath();
                        ctx.arc(x, y, 2, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }

                // æ›´æ–°æŠ¤ç›¾çŠ¶æ€
                function updateShield() {
                    if (gameState.shieldActive) {
                        gameState.shieldTime -= 16; // å‡è®¾60fpsï¼Œæ¯å¸§çº¦16ms
                        if (gameState.shieldTime <= 0) {
                            gameState.shieldActive = false;
                            gameState.shieldTime = 0;
                        }
                    }
                }

                // è‡ªåŠ¨é©¾é©¶ç³»ç»Ÿ
                function updateAutopilot() {
                    const now = Date.now();
                    const player = gameState.player;

                    // æ™ºèƒ½èº²é¿æ•Œæœºå’Œå­å¼¹
                    let dangerX = null;
                    let minDistance = Infinity;

                    // æ£€æµ‹æœ€è¿‘çš„å¨èƒ
                    [...gameState.enemies, ...gameState.bullets.filter(b => b.isEnemy)].forEach(threat => {
                        const distance = Math.sqrt(
                            Math.pow(threat.x - player.x, 2) +
                            Math.pow(threat.y - player.y, 2)
                        );

                        if (distance < minDistance && threat.y > player.y - 150) {
                            minDistance = distance;
                            dangerX = threat.x;
                        }
                    });

                    // æ™ºèƒ½ç§»åŠ¨é€»è¾‘
                    if (dangerX !== null && minDistance < 100) {
                        // æœ‰å¨èƒæ—¶èº²é¿
                        gameState.autopilot.avoidanceMode = true;
                        if (dangerX < player.x) {
                            gameState.autopilot.targetX = Math.min(canvas.width - 50, player.x + 80);
                        } else {
                            gameState.autopilot.targetX = Math.max(50, player.x - 80);
                        }
                    } else {
                        // æ— å¨èƒæ—¶å·¡é€»
                        gameState.autopilot.avoidanceMode = false;
                        if (now - gameState.autopilot.lastDirectionChange > 2000) {
                            gameState.autopilot.targetX = 100 + Math.random() * (canvas.width - 200);
                            gameState.autopilot.lastDirectionChange = now;
                        }
                    }

                    // å¹³æ»‘ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®
                    const dx = gameState.autopilot.targetX - player.x;
                    const moveSpeed = gameState.autopilot.avoidanceMode ? 8 : 4;

                    if (Math.abs(dx) > 5) {
                        player.x += Math.sign(dx) * moveSpeed;
                        player.x = Math.max(30, Math.min(canvas.width - 30, player.x));
                    }
                }

                // åˆ›å»ºçˆ†ç‚¸æ•ˆæœ
                function createExplosion(x, y, size = 'normal') {
                    let particleCount, particleSize, colors;

                    switch (size) {
                        case 'small':
                            particleCount = 15;
                            particleSize = 3;
                            colors = ['#ff6600', '#ffaa00', '#ffdd00'];
                            break;
                        case 'large':
                            particleCount = 40;
                            particleSize = 6;
                            colors = ['#ff0000', '#ff6600', '#ffaa00', '#ffffff'];
                            break;
                        default: // normal
                            particleCount = 25;
                            particleSize = 4;
                            colors = ['#ff3300', '#ff6600', '#ffaa00'];
                    }

                    for (let i = 0; i < particleCount; i++) {
                        const angle = (Math.PI * 2 * i) / particleCount + Math.random() * 0.5;
                        const speed = Math.random() * 8 + 3;
                        const color = colors[Math.floor(Math.random() * colors.length)];

                        gameState.particles.push({
                            x: x,
                            y: y,
                            vx: Math.cos(angle) * speed,
                            vy: Math.sin(angle) * speed,
                            life: 40 + Math.random() * 20,
                            maxLife: 60,
                            size: particleSize + Math.random() * 2,
                            color: color,
                            type: 'explosion'
                        });
                    }
                }

                // ç»˜åˆ¶ç²’å­æ•ˆæœ
                function drawParticles() {
                    gameState.particles.forEach((particle, index) => {
                        particle.life--;
                        particle.x += particle.vx;
                        particle.y += particle.vy;

                        // æ ¹æ®ç²’å­ç±»å‹åº”ç”¨ä¸åŒæ•ˆæœ
                        if (particle.type === 'explosion') {
                            particle.vx *= 0.98; // é˜»åŠ›
                            particle.vy *= 0.98;
                            particle.size *= 0.95; // ç¼©å°
                        } else if (particle.type === 'shield') {
                            // æŠ¤ç›¾ç²’å­å›´ç»•ç©å®¶æ—‹è½¬
                            const angle = Math.atan2(particle.y - gameState.player.y, particle.x - gameState.player.x);
                            particle.x = gameState.player.x + Math.cos(angle + 0.05) * 45;
                            particle.y = gameState.player.y + Math.sin(angle + 0.05) * 45;
                        } else if (particle.type === 'trail') {
                            particle.vy += 0.2; // é‡åŠ›
                            particle.size *= 0.9;
                        }

                        // è®¡ç®—é€æ˜åº¦
                        const alpha = particle.life / particle.maxLife;

                        ctx.save();
                        ctx.globalAlpha = alpha;
                        ctx.fillStyle = particle.color;

                        // æ ¹æ®ç²’å­ç±»å‹ç»˜åˆ¶ä¸åŒå½¢çŠ¶
                        if (particle.type === 'explosion') {
                            ctx.shadowColor = particle.color;
                            ctx.shadowBlur = 10;
                            ctx.beginPath();
                            ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                            ctx.fill();
                        } else if (particle.type === 'shield') {
                            ctx.shadowColor = particle.color;
                            ctx.shadowBlur = 8;
                            ctx.beginPath();
                            ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                            ctx.fill();
                        } else if (particle.type === 'success') {
                            // æˆåŠŸç²’å­ - æ˜Ÿå½¢
                            ctx.shadowColor = particle.color;
                            ctx.shadowBlur = 15;
                            drawStar(particle.x, particle.y, particle.size);
                        } else if (particle.type === 'error') {
                            // é”™è¯¯ç²’å­ - åå­—å½¢
                            ctx.lineWidth = 2;
                            ctx.strokeStyle = particle.color;
                            ctx.shadowColor = particle.color;
                            ctx.shadowBlur = 8;
                            ctx.beginPath();
                            ctx.moveTo(particle.x - particle.size, particle.y);
                            ctx.lineTo(particle.x + particle.size, particle.y);
                            ctx.moveTo(particle.x, particle.y - particle.size);
                            ctx.lineTo(particle.x, particle.y + particle.size);
                            ctx.stroke();
                        } else {
                            // é»˜è®¤åœ†å½¢ç²’å­
                            ctx.beginPath();
                            ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                            ctx.fill();
                        }

                        ctx.restore();

                        // ç§»é™¤ç”Ÿå‘½å‘¨æœŸç»“æŸçš„ç²’å­
                        if (particle.life <= 0) {
                            gameState.particles.splice(index, 1);
                        }
                    });
                }

                // ç»˜åˆ¶æ˜Ÿå½¢
                function drawStar(x, y, size) {
                    ctx.beginPath();
                    for (let i = 0; i < 5; i++) {
                        const angle = (i * 4 * Math.PI) / 5;
                        const x1 = x + Math.cos(angle) * size;
                        const y1 = y + Math.sin(angle) * size;
                        if (i === 0) ctx.moveTo(x1, y1);
                        else ctx.lineTo(x1, y1);
                    }
                    ctx.closePath();
                    ctx.fill();
                }

                // æ˜¾ç¤ºé¢˜ç›®
                function showQuestion() {
                    if (gameState.questionActive) return;

                    const question = mathQuestions[Math.floor(Math.random() * mathQuestions.length)];
                    gameState.currentQuestion = question;
                    gameState.questionActive = true;
                    gameState.questionTimer = 15;

                    // å¯åŠ¨è‡ªåŠ¨é©¾é©¶
                    gameState.autopilot.active = true;
                    gameState.autopilot.targetX = canvas.width / 2;

                    // æ˜¾ç¤ºé¢˜ç›®é¢æ¿
                    const panel = document.getElementById('questionPanel');
                    const questionDiv = document.getElementById('gameQuestion');
                    const optionsDiv = document.getElementById('answerOptions');

                    questionDiv.textContent = question.question;
                    optionsDiv.innerHTML = '';

                    question.options.forEach((option, index) => {
                        const button = document.createElement('button');
                        button.className = 'bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-space transition-colors text-sm';
                        button.textContent = option;
                        button.onclick = () => answerQuestion(index);
                        optionsDiv.appendChild(button);
                    });

                    panel.style.transform = 'translateY(0)';

                    // å¼€å§‹è®¡æ—¶
                    const timerInterval = setInterval(() => {
                        gameState.questionTimer--;
                        const timerBar = document.getElementById('timerBar');
                        timerBar.style.width = `${(gameState.questionTimer / 15) * 100}%`;

                        if (gameState.questionTimer <= 0) {
                            clearInterval(timerInterval);
                            answerQuestion(-1); // è¶…æ—¶
                        }
                    }, 1000);
                }

                // å›ç­”é—®é¢˜
                function answerQuestion(selectedIndex) {
                    if (!gameState.questionActive) return;

                    gameState.questionActive = false;
                    // å…³é—­è‡ªåŠ¨é©¾é©¶
                    gameState.autopilot.active = false;

                    const panel = document.getElementById('questionPanel');
                    panel.style.transform = 'translateY(100%)';

                    if (selectedIndex === gameState.currentQuestion.correct) {
                        // ç­”å¯¹äº†
                        gameState.score += 100;
                        gameState.player.health = Math.min(100, gameState.player.health + 20);

                        // éšæœºè£…å¤‡å‡çº§å¥–åŠ±
                        const upgradeChance = Math.random();
                        if (upgradeChance < 0.3) { // 30%æ¦‚ç‡è·å¾—è£…å¤‡å‡çº§
                            const upgradeTypes = ['weapon', 'shield', 'speed', 'health', 'fireRate', 'multiShot', 'laser', 'bomb'];
                            const randomUpgrade = upgradeTypes[Math.floor(Math.random() * upgradeTypes.length)];
                            upgradeSystem.upgradeEquipment(randomUpgrade);
                        }

                        // æ ¹æ®é¢˜ç›®ç±»å‹å’Œæˆ˜æ–—æ¨¡å¼ç»™äºˆä¸åŒå¥–åŠ±
                        const battleMode = gameState.currentQuestion.battleMode;

                        if (battleMode === 'rapid_fire') {
                            // æ ‡å‡†å½¢å¼é¢˜ç›®ï¼šå¿«é€Ÿå°„å‡»æ¨¡å¼
                            gameState.shootCooldown = Math.max(50, gameState.shootCooldown - 30);
                            // ç”Ÿæˆå¤šå‘å­å¼¹
                            for (let i = -1; i <= 1; i++) {
                                createBullet(gameState.player.x + i * 20, gameState.player.y - 30, 'rapid');
                            }
                            // æ¸…é™¤éƒ¨åˆ†æ•Œæœº
                            const enemiesToRemove = Math.min(3, gameState.enemies.length);
                            for (let i = 0; i < enemiesToRemove; i++) {
                                const enemy = gameState.enemies[i];
                                createExplosion(enemy.x, enemy.y);
                                gameState.score += 10;
                            }
                            gameState.enemies.splice(0, enemiesToRemove);

                        } else if (battleMode === 'shield_mode') {
                            // åº”ç”¨é¢˜ï¼šæŠ¤ç›¾æ¨¡å¼
                            gameState.player.health = 100; // å®Œå…¨æ¢å¤è¡€é‡
                            // ç”ŸæˆæŠ¤ç›¾æ•ˆæœ
                            createShieldEffect();
                            // ç”Ÿæˆæ¿€å…‰æ­¦å™¨
                            for (let i = 0; i < 5; i++) {
                                setTimeout(() => {
                                    createBullet(gameState.player.x, gameState.player.y - 30, 'laser');
                                }, i * 100);
                            }

                        } else if (battleMode === 'boss_fight') {
                            // æ ¹çš„åˆ¤æ–­ï¼šBossæˆ˜æ¨¡å¼
                            // æ¸…é™¤æ‰€æœ‰æ™®é€šæ•Œæœº
                            gameState.enemies.forEach(enemy => {
                                if (enemy.type !== 'boss') {
                                    createExplosion(enemy.x, enemy.y);
                                    gameState.score += 10;
                                }
                            });
                            gameState.enemies = gameState.enemies.filter(enemy => enemy.type === 'boss');

                            // ç”Ÿæˆè¶…çº§æ­¦å™¨
                            createSuperWeapon();

                            // å¦‚æœæ²¡æœ‰Bossï¼Œç”Ÿæˆä¸€ä¸ª
                            if (gameState.enemies.length === 0) {
                                createEnemy('boss');
                            }
                        }

                        // æ˜¾ç¤ºç­”å¯¹ç‰¹æ•ˆ
                        showCorrectEffect();

                    } else {
                        // ç­”é”™äº†
                        gameState.player.health -= 30;

                        // æ ¹æ®æˆ˜æ–—æ¨¡å¼ç»™äºˆä¸åŒæƒ©ç½š
                        const battleMode = gameState.currentQuestion.battleMode;

                        if (battleMode === 'rapid_fire') {
                            // ç”Ÿæˆæ›´å¤šæ•Œæœº
                            for (let i = 0; i < 3; i++) {
                                createEnemy('normal');
                            }
                        } else if (battleMode === 'shield_mode') {
                            // ç”Ÿæˆå¼ºåŠ›æ•Œæœº
                            createEnemy('strong');
                            createEnemy('strong');
                        } else if (battleMode === 'boss_fight') {
                            // ç”ŸæˆBoss
                            createEnemy('boss');
                        }

                        // æ˜¾ç¤ºç­”é”™ç‰¹æ•ˆ
                        showWrongEffect();

                        if (gameState.player.health <= 0) {
                            endGame();
                        }
                    }

                    updateUI();
                }

                // åˆ›å»ºæŠ¤ç›¾æ•ˆæœ
                function createShieldEffect() {
                    gameState.shieldActive = true;
                    gameState.shieldTime = 5000; // 5ç§’æŠ¤ç›¾

                    // æŠ¤ç›¾ç²’å­æ•ˆæœ
                    for (let i = 0; i < 20; i++) {
                        const angle = (i / 20) * Math.PI * 2;
                        gameState.particles.push({
                            x: gameState.player.x + Math.cos(angle) * 40,
                            y: gameState.player.y + Math.sin(angle) * 40,
                            vx: Math.cos(angle) * 2,
                            vy: Math.sin(angle) * 2,
                            life: 100,
                            maxLife: 100,
                            size: 3,
                            color: '#00ffff',
                            type: 'shield'
                        });
                    }
                }

                // åˆ›å»ºè¶…çº§æ­¦å™¨
                function createSuperWeapon() {
                    // å‘å°„å¤šæ–¹å‘æ¿€å…‰
                    for (let angle = 0; angle < 360; angle += 30) {
                        const rad = (angle * Math.PI) / 180;
                        gameState.bullets.push({
                            x: gameState.player.x,
                            y: gameState.player.y,
                            width: 6,
                            height: 20,
                            speed: 10,
                            type: 'super',
                            damage: 5,
                            vx: Math.cos(rad) * 8,
                            vy: Math.sin(rad) * 8
                        });
                    }
                }

                // æ˜¾ç¤ºç­”å¯¹ç‰¹æ•ˆ
                function showCorrectEffect() {
                    for (let i = 0; i < 30; i++) {
                        gameState.particles.push({
                            x: gameState.player.x,
                            y: gameState.player.y,
                            vx: (Math.random() - 0.5) * 15,
                            vy: (Math.random() - 0.5) * 15,
                            life: 60,
                            maxLife: 60,
                            size: Math.random() * 6 + 2,
                            color: '#00ff00',
                            type: 'success'
                        });
                    }
                }

                // æ˜¾ç¤ºç­”é”™ç‰¹æ•ˆ
                function showWrongEffect() {
                    for (let i = 0; i < 20; i++) {
                        gameState.particles.push({
                            x: gameState.player.x,
                            y: gameState.player.y,
                            vx: (Math.random() - 0.5) * 10,
                            vy: (Math.random() - 0.5) * 10,
                            life: 40,
                            maxLife: 40,
                            size: Math.random() * 4 + 2,
                            color: '#ff0000',
                            type: 'error'
                        });
                    }
                }

                // åˆ›å»ºåä¸½è£…å¤‡å‡çº§ç³»ç»Ÿ
                function createUpgradeSystem() {
                    // å‡çº§è£…å¤‡
                    function upgradeEquipment(type) {
                        const items = gameState.persistentItems;

                        switch (type) {
                            case 'weapon':
                                if (items.weaponLevel < 5) {
                                    items.weaponLevel++;
                                    showUpgradeEffect('æ­¦å™¨å‡çº§ï¼', '#ff6600');
                                    updateWeaponStats();
                                }
                                break;
                            case 'shield':
                                if (items.shieldLevel < 3) {
                                    items.shieldLevel++;
                                    showUpgradeEffect('æŠ¤ç›¾å‡çº§ï¼', '#00ffff');
                                    updateShieldStats();
                                }
                                break;
                            case 'speed':
                                if (items.speedLevel < 3) {
                                    items.speedLevel++;
                                    showUpgradeEffect('é€Ÿåº¦å‡çº§ï¼', '#00ff00');
                                    updateSpeedStats();
                                }
                                break;
                            case 'health':
                                if (items.healthLevel < 3) {
                                    items.healthLevel++;
                                    showUpgradeEffect('ç”Ÿå‘½å‡çº§ï¼', '#ff0080');
                                    updateHealthStats();
                                }
                                break;
                            case 'fireRate':
                                if (items.fireRateLevel < 3) {
                                    items.fireRateLevel++;
                                    showUpgradeEffect('å°„é€Ÿå‡çº§ï¼', '#ffff00');
                                    updateFireRateStats();
                                }
                                break;
                            case 'multiShot':
                                if (items.multiShotLevel < 3) {
                                    items.multiShotLevel++;
                                    showUpgradeEffect('å¤šé‡å°„å‡»å‡çº§ï¼', '#ff00ff');
                                    updateMultiShotStats();
                                }
                                break;
                            case 'laser':
                                if (items.laserLevel < 3) {
                                    items.laserLevel++;
                                    showUpgradeEffect('æ¿€å…‰å‡çº§ï¼', '#ff0000');
                                    updateLaserStats();
                                }
                                break;
                            case 'bomb':
                                if (items.bombLevel < 3) {
                                    items.bombLevel++;
                                    showUpgradeEffect('ç‚¸å¼¹å‡çº§ï¼', '#ff8800');
                                    updateBombStats();
                                }
                                break;
                        }
                    }

                    // æ˜¾ç¤ºå‡çº§ç‰¹æ•ˆ
                    function showUpgradeEffect(text, color) {
                        const effect = document.createElement('div');
                        effect.style.position = 'fixed';
                        effect.style.left = '50%';
                        effect.style.top = '30%';
                        effect.style.transform = 'translateX(-50%)';
                        effect.style.color = color;
                        effect.style.fontSize = '24px';
                        effect.style.fontWeight = 'bold';
                        effect.style.textShadow = `0 0 10px ${color}`;
                        effect.style.zIndex = '1000';
                        effect.style.pointerEvents = 'none';
                        effect.textContent = text;

                        document.body.appendChild(effect);

                        // åŠ¨ç”»æ•ˆæœ
                        let opacity = 1;
                        let scale = 1;
                        const animate = () => {
                            opacity -= 0.02;
                            scale += 0.02;
                            effect.style.opacity = opacity;
                            effect.style.transform = `translateX(-50%) scale(${scale})`;

                            if (opacity > 0) {
                                requestAnimationFrame(animate);
                            } else {
                                document.body.removeChild(effect);
                            }
                        };
                        animate();
                    }

                    // æ›´æ–°æ­¦å™¨å±æ€§
                    function updateWeaponStats() {
                        const level = gameState.persistentItems.weaponLevel;
                        gameState.shootCooldown = Math.max(100, 200 - level * 20);
                    }

                    // æ›´æ–°æŠ¤ç›¾å±æ€§
                    function updateShieldStats() {
                        const level = gameState.persistentItems.shieldLevel;
                        if (level > 0) {
                            gameState.shieldActive = true;
                            gameState.shieldTime = level * 5000; // æ¯çº§5ç§’
                        }
                    }

                    // æ›´æ–°é€Ÿåº¦å±æ€§
                    function updateSpeedStats() {
                        // é€Ÿåº¦å‡çº§å½±å“ç©å®¶ç§»åŠ¨é€Ÿåº¦
                        // åœ¨drawPlayerå‡½æ•°ä¸­ä¼šä½¿ç”¨è¿™ä¸ªå€¼
                    }

                    // æ›´æ–°ç”Ÿå‘½å±æ€§
                    function updateHealthStats() {
                        const level = gameState.persistentItems.healthLevel;
                        gameState.player.health = Math.min(100 + level * 25, gameState.player.health + 25);
                    }

                    // æ›´æ–°å°„é€Ÿå±æ€§
                    function updateFireRateStats() {
                        const level = gameState.persistentItems.fireRateLevel;
                        gameState.shootCooldown = Math.max(50, 200 - level * 50);
                    }

                    // æ›´æ–°å¤šé‡å°„å‡»å±æ€§
                    function updateMultiShotStats() {
                        // å¤šé‡å°„å‡»åœ¨createBulletå‡½æ•°ä¸­å¤„ç†
                    }

                    // æ›´æ–°æ¿€å…‰å±æ€§
                    function updateLaserStats() {
                        // æ¿€å…‰å±æ€§åœ¨createBulletå‡½æ•°ä¸­å¤„ç†
                    }

                    // æ›´æ–°ç‚¸å¼¹å±æ€§
                    function updateBombStats() {
                        // ç‚¸å¼¹å±æ€§åœ¨ç‰¹æ®Šæ”»å‡»ä¸­å¤„ç†
                    }

                    return { upgradeEquipment };
                }

                // åˆå§‹åŒ–å‡çº§ç³»ç»Ÿ
                const upgradeSystem = createUpgradeSystem();

                // åˆ›å»ºé“å…·
                function createPowerUp(x, y, type) {
                    gameState.powerUps.push({
                        x: x,
                        y: y,
                        type: type,
                        life: 300
                    });
                }

                // æ›´æ–°UI
                function updateUI() {
                    document.getElementById('gameHealth').textContent = gameState.player.health;
                    document.getElementById('gameScore').textContent = gameState.score;
                    document.getElementById('gameLevel').textContent = gameState.level;

                    const minutes = Math.floor(gameState.gameTime / 60);
                    const seconds = gameState.gameTime % 60;
                    document.getElementById('gameTime').textContent =
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }

                // ç»“æŸæ¸¸æˆ
                function endGame() {
                    gameState.isRunning = false;

                    const gameContainer = document.getElementById('spaceGameContainer');
                    const endScreen = document.createElement('div');
                    endScreen.className = 'absolute inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50';
                    endScreen.innerHTML = `
                        <div class="glass-effect p-8 rounded-2xl text-center max-w-md">
                            <h2 class="text-3xl font-bold mb-4 text-primary">æ¸¸æˆç»“æŸ</h2>
                            <p class="text-xl mb-2">æœ€ç»ˆå¾—åˆ†: <span class="text-yellow-500">${gameState.score}</span></p>
                            <p class="text-lg mb-6">ç­‰çº§: <span class="text-green-500">${gameState.level}</span></p>
                            <button id="restartBtn" class="bg-gradient-to-r from-primary to-secondary px-6 py-3 rounded-full hover:opacity-90 transition-opacity">
                                é‡æ–°å¼€å§‹
                            </button>
                        </div>
                    `;

                    gameContainer.appendChild(endScreen);

                    document.getElementById('restartBtn').onclick = () => {
                        document.body.removeChild(gameContainer);
                        launchSpaceGame();
                    };
                }

                // æ¸¸æˆä¸»å¾ªç¯
                function gameLoop() {
                    if (!gameState.isRunning) return;

                    // æ¸…ç©ºç”»å¸ƒå¹¶ç»˜åˆ¶æ»šåŠ¨èƒŒæ™¯
                    drawScrollingBackground();

                    // ç»˜åˆ¶æ¸¸æˆå…ƒç´ 
                    drawStars();
                    drawPlayer();
                    drawBullets();
                    drawEnemies();
                    drawParticles();

                    // æ›´æ–°æŠ¤ç›¾çŠ¶æ€
                    updateShield();

                    // è‡ªåŠ¨é©¾é©¶é€»è¾‘
                    if (gameState.autopilot.active) {
                        updateAutopilot();
                    }

                    // ç©å®¶å°„å‡»
                    const now = Date.now();
                    if (now - gameState.lastShot > gameState.shootCooldown) {
                        createBullet(gameState.player.x, gameState.player.y - 30);
                        gameState.lastShot = now;
                    }

                    // ç”Ÿæˆæ•Œæœº
                    if (now - gameState.lastEnemySpawn > gameState.enemySpawnRate) {
                        const rand = Math.random();
                        if (rand < 0.05) {
                            createEnemy('boss');
                        } else if (rand < 0.15) {
                            createEnemy('bomber');
                        } else if (rand < 0.25) {
                            createEnemy('sniper');
                        } else if (rand < 0.35) {
                            createEnemy('heavy');
                        } else if (rand < 0.45) {
                            createEnemy('scout');
                        } else if (rand < 0.65) {
                            createEnemy('strong');
                        } else {
                            createEnemy('normal');
                        }
                        gameState.lastEnemySpawn = now;
                    }

                    // ç¢°æ’æ£€æµ‹
                    checkCollisions();

                    // éšæœºæ˜¾ç¤ºé¢˜ç›®
                    if (Math.random() < 0.002 && !gameState.questionActive) {
                        showQuestion();
                    }

                    // æ¸¸æˆæ—¶é—´å€’è®¡æ—¶
                    if (now % 1000 < 16) { // å¤§çº¦æ¯ç§’æ‰§è¡Œä¸€æ¬¡
                        gameState.gameTime--;
                        if (gameState.gameTime <= 0) {
                            endGame();
                        }
                        updateUI();
                    }

                    requestAnimationFrame(gameLoop);
                }

                // é€€å‡ºæ¸¸æˆ
                document.getElementById('exitGameBtn').addEventListener('click', function () {
                    gameState.isRunning = false;
                    const gameContainer = document.getElementById('spaceGameContainer');
                    gameContainer.style.animation = 'fadeOut 0.5s ease-out';
                    setTimeout(() => {
                        document.body.removeChild(gameContainer);
                    }, 500);
                });

                // éšè—æç¤º
                setTimeout(() => {
                    const hints = document.getElementById('gameHints');
                    hints.style.opacity = '0';
                    hints.style.transition = 'opacity 2s ease-out';
                }, 3000);

                // å¼€å§‹æ¸¸æˆå¾ªç¯
                updateUI();
                gameLoop();
            }
            document.querySelectorAll('.interactive-btn').forEach(btn => {
                btn.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 10px 25px rgba(0,0,0,0.3)';
                });

                btn.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
                });
            });
        }

        // åˆå§‹åŒ–ç§»åŠ¨ç«¯èœå•
        function initMobileMenu() {
            const mobileMenuBtn = document.getElementById('menuToggle');
            const mobileMenu = document.getElementById('mobileMenu');

            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function () {
                    mobileMenu.classList.toggle('hidden');
                });
            }
        }

        // å…¨å±æ¨¡å¼åŠŸèƒ½
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                // è¿›å…¥å…¨å±
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`å…¨å±è¯·æ±‚é”™è¯¯: ${err.message}`);
                });
            } else {
                // é€€å‡ºå…¨å±
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // æ›´æ–°å…¨å±æŒ‰é’®çŠ¶æ€
        function updateFullScreenButton() {
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const mobileFullscreenBtn = document.getElementById('mobileFullscreenBtn');

            const isFullscreen = document.fullscreenElement;

            if (fullscreenBtn) {
                if (isFullscreen) {
                    fullscreenBtn.innerHTML = '<i class="fa fa-compress"></i> é€€å‡ºå…¨å±';
                } else {
                    fullscreenBtn.innerHTML = '<i class="fa fa-expand"></i> å…¨å±æ¨¡å¼';
                }
            }

            if (mobileFullscreenBtn) {
                if (isFullscreen) {
                    mobileFullscreenBtn.innerHTML = '<i class="fa fa-compress"></i> é€€å‡ºå…¨å±';
                } else {
                    mobileFullscreenBtn.innerHTML = '<i class="fa fa-expand"></i> å…¨å±æ¨¡å¼';
                }
            }
        }

        // ç›‘å¬å…¨å±çŠ¶æ€å˜åŒ–
        document.addEventListener('fullscreenchange', updateFullScreenButton);

        // åˆå§‹åŒ–å…¨å±æŒ‰é’®äº‹ä»¶ç»‘å®š
        document.addEventListener('DOMContentLoaded', function () {
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const mobileFullscreenBtn = document.getElementById('mobileFullscreenBtn');

            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', toggleFullScreen);
            }

            if (mobileFullscreenBtn) {
                mobileFullscreenBtn.addEventListener('click', toggleFullScreen);
            }
        });

        // çª—å£å¤§å°æ”¹å˜æ—¶é‡ç»˜å›¾åƒ
        window.addEventListener('resize', function () {
            setTimeout(() => {
                drawConceptGraph1();
                drawRootsVisualization();
                initSpacecraftSolver();
                initSatelliteAnalyzer();
                drawSpaceStatue();
                drawMainFunctionGraph();
            }, 100);
        });
    </script>
</body>

</html>