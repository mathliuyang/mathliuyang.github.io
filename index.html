<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人网站</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg: #000000;
            --text: #ffffff;
            --text-dim: #666666;
            --accent: #ffffff;
            --border: rgba(255, 255, 255, 0.08);
        }

        [data-theme="light"] {
            --bg: #ffffff;
            --text: #000000;
            --text-dim: #999999;
            --accent: #000000;
            --border: rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.8;
            overflow-x: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: -0.02em;
        }

        #canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        /* 导航 */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 2rem 4rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: padding 0.3s ease;
        }

        nav.scrolled {
            padding: 1.5rem 4rem;
            background: rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid var(--border);
        }

        [data-theme="light"] nav.scrolled {
            background: rgba(255, 255, 255, 0.8);
        }

        .logo {
            font-size: 1rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            opacity: 0;
            animation: fadeIn 1s ease 0.2s forwards;
        }

        .nav-right {
            display: flex;
            gap: 3rem;
            align-items: center;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            list-style: none;
            opacity: 0;
            animation: fadeIn 1s ease 0.4s forwards;
        }

        .nav-links a {
            color: var(--text-dim);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            letter-spacing: 0.02em;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--text);
        }

        .theme-btn {
            width: 36px;
            height: 36px;
            border: 1px solid var(--border);
            background: transparent;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 1s ease 0.6s forwards;
        }

        .theme-btn:hover {
            border-color: var(--text);
            transform: scale(1.1);
        }

        /* Hero */
        .hero {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 4rem;
            z-index: 1;
        }

        .hero-content {
            max-width: 900px;
        }

        .hero h1 {
            font-size: clamp(3rem, 8vw, 7rem);
            font-weight: 300;
            line-height: 1.1;
            margin-bottom: 2rem;
            opacity: 0;
            animation: slideUp 1s ease 0.3s forwards;
        }

        .hero h1 strong {
            font-weight: 600;
        }

        .hero-subtitle {
            font-size: clamp(1rem, 2vw, 1.5rem);
            color: var(--text-dim);
            margin-bottom: 3rem;
            opacity: 0;
            animation: slideUp 1s ease 0.5s forwards;
        }

        .hero-meta {
            display: flex;
            gap: 4rem;
            opacity: 0;
            animation: slideUp 1s ease 0.7s forwards;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .meta-number {
            font-size: 2.5rem;
            font-weight: 300;
            letter-spacing: -0.03em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .meta-number:hover {
            transform: scale(1.05);
            color: var(--accent);
        }

        /* 访问量计数器样式 */
        #visitorCount {
            position: relative;
            display: inline-block;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #visitorCount:hover {
            transform: scale(1.05);
            color: var(--accent);
        }

        /* 加载状态样式 */
        #visitorCount.loading {
            opacity: 0.7;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        .meta-label {
            font-size: 0.85rem;
            color: var(--text-dim);
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        .scroll-hint {
            position: absolute;
            bottom: 4rem;
            left: 4rem;
            font-size: 0.85rem;
            color: var(--text-dim);
            letter-spacing: 0.05em;
            opacity: 0;
            animation: fadeIn 1s ease 1.5s forwards, float 2s ease-in-out 2s infinite;
        }

        /* Cards Section */
        .cards-section {
            position: relative;
            padding: 8rem 4rem;
            z-index: 1;
        }

        .section-title {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 300;
            margin-bottom: 4rem;
            letter-spacing: -0.02em;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
        }

        .card {
            border: 1px solid var(--border);
            padding: 3rem;
            background: transparent;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: var(--accent);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card:hover::before {
            transform: scaleX(1);
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
        }

        .card-number {
            font-size: 0.85rem;
            color: var(--text-dim);
            margin-bottom: 2rem;
            letter-spacing: 0.05em;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 400;
            margin-bottom: 1rem;
            letter-spacing: -0.01em;
        }

        .card-desc {
            font-size: 0.95rem;
            color: var(--text-dim);
            line-height: 1.6;
        }

        .card-arrow {
            position: absolute;
            bottom: 3rem;
            right: 3rem;
            font-size: 1.5rem;
            opacity: 0;
            transform: translateX(-10px);
            transition: all 0.4s ease;
        }

        .card:hover .card-arrow {
            opacity: 1;
            transform: translateX(0);
        }

        /* Footer */
        footer {
            position: relative;
            padding: 4rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1;
        }

        .footer-text {
            font-size: 0.85rem;
            color: var(--text-dim);
            letter-spacing: 0.05em;
        }

        .social-links {
            display: flex;
            gap: 2rem;
        }

        .social-links a {
            color: var(--text-dim);
            text-decoration: none;
            font-size: 0.85rem;
            letter-spacing: 0.05em;
            transition: color 0.3s ease;
        }

        .social-links a:hover {
            color: var(--text);
        }

        /* Animations */
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            nav {
                padding: 1.5rem 2rem;
            }

            nav.scrolled {
                padding: 1rem 2rem;
            }

            .nav-links {
                display: none;
            }

            .hero {
                padding: 0 2rem;
            }

            .hero-meta {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 2rem;
                max-width: 400px;
                margin: 0 auto;
            }

            .scroll-hint {
                left: 2rem;
            }

            .cards-section {
                padding: 4rem 2rem;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            footer {
                padding: 3rem 2rem;
                flex-direction: column;
                gap: 2rem;
                text-align: center;
            }
        }
    </style>
</head>

<body>
    <canvas id="canvas"></canvas>

    <!-- Navigation -->
    <nav id="nav">
        <div class="logo">图灵的猫</div>
        <div class="nav-right">
            <ul class="nav-links">
                <li><a href="pages/about.html">关于我</a></li>
                <li><a href="pages/blog.html">博客</a></li>
                <li><a href="pages/projects.html">项目</a></li>
                <li><a href="pages/publications.html">学术成果</a></li>
                <li><a href="pages/tools.html">工具箱</a></li>
                <li><a href="pages/contact.html">联系我</a></li>
            </ul>
            <button class="theme-btn" id="themeBtn">
                <span id="themeIcon">◐</span>
            </button>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1>探索<strong>计算数学</strong><br>的<strong>无限可能</strong></h1>
            <p class="hero-subtitle">
                一位被偏微分方程带偏了的人工智能算法开发者
            </p>
            <div class="hero-meta">
                <div class="meta-item">
                    <div class="meta-number" data-target="9">00</div>
                    <div class="meta-label">学术论文</div>
                </div>
                <div class="meta-item">
                    <div class="meta-number" data-target="15">00</div>
                    <div class="meta-label">科研项目</div>
                </div>
                <div class="meta-item">
                    <div class="meta-number" data-target="8">00</div>
                    <div class="meta-label">实用工具</div>
                </div>
                <div class="meta-item">
                    <div class="meta-number" id="visitorCount">2,847</div>
                    <div class="meta-label">访问量</div>
                </div>
            </div>
        </div>
        <div class="scroll-hint">SCROLL TO EXPLORE</div>
    </section>

    <!-- Cards Section -->
    <section class="cards-section">
        <h2 class="section-title">探索我的作品</h2>
        <div class="cards-grid">
            <div class="card" onclick="location.href='pages/about.html'">
                <div class="card-number">01</div>
                <h3 class="card-title">关于我</h3>
                <p class="card-desc">教育背景、研究方向与学术经历</p>
                <div class="card-arrow">→</div>
            </div>
            <div class="card" onclick="location.href='pages/blog.html'">
                <div class="card-number">02</div>
                <h3 class="card-title">博客</h3>
                <p class="card-desc">研究心得与学术思考分享</p>
                <div class="card-arrow">→</div>
            </div>
            <div class="card" onclick="location.href='pages/projects.html'">
                <div class="card-number">03</div>
                <h3 class="card-title">项目作品</h3>
                <p class="card-desc">开源项目和实战案例展示</p>
                <div class="card-arrow">→</div>
            </div>
            <div class="card" onclick="location.href='pages/publications.html'">
                <div class="card-number">04</div>
                <h3 class="card-title">论文专著</h3>
                <p class="card-desc">发表的学术论文与研究成果</p>
                <div class="card-arrow">→</div>
            </div>
            <div class="card" onclick="location.href='pages/tools.html'">
                <div class="card-number">05</div>
                <h3 class="card-title">工具箱</h3>
                <p class="card-desc">数值计算与科学计算工具箱</p>
                <div class="card-arrow">→</div>
            </div>
            <div class="card" onclick="location.href='pages/contact.html'">
                <div class="card-number">06</div>
                <h3 class="card-title">学术交流</h3>
                <p class="card-desc">学术合作与联系方式</p>
                <div class="card-arrow">→</div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-text">© 2025 刘洋 | AIDING 团队</div>
        <div class="social-links">
            <a href="mailto:mathliuyang@163.com">学术邮箱</a>
            <a href="https://github.com/mathliuyang/" target="_blank">GitHub</a>
            <a href="#" class="copy-wechat" data-copy="TuringsCat">微信</a>
            <a href="#" class="copy-qq" data-copy="TuringsCat">QQ</a>
        </div>
    </footer>

    <script>
        // Canvas Setup
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        let mouse = { x: null, y: null, radius: 150 };

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        // Mouse tracking
        window.addEventListener('mousemove', (e) => {
            mouse.x = e.x;
            mouse.y = e.y;
        });

        window.addEventListener('mouseout', () => {
            mouse.x = null;
            mouse.y = null;
        });

        // Particle class
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2 + 0.5;
                this.baseX = this.x;
                this.baseY = this.y;
                this.density = Math.random() * 30 + 1;
                this.vx = (Math.random() - 0.5) * 0.3;
                this.vy = (Math.random() - 0.5) * 0.3;
            }

            draw() {
                const theme = document.documentElement.getAttribute('data-theme');
                ctx.fillStyle = theme === 'light' ? 'rgba(0, 0, 0, 0.3)' : 'rgba(255, 255, 255, 0.3)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }

            update() {
                // Mouse interaction
                if (mouse.x != null && mouse.y != null) {
                    let dx = mouse.x - this.x;
                    let dy = mouse.y - this.y;
                    let distance = Math.sqrt(dx * dx + dy * dy);
                    let forceDirectionX = dx / distance;
                    let forceDirectionY = dy / distance;
                    let maxDistance = mouse.radius;
                    let force = (maxDistance - distance) / maxDistance;
                    let directionX = forceDirectionX * force * this.density * 0.6;
                    let directionY = forceDirectionY * force * this.density * 0.6;

                    if (distance < mouse.radius) {
                        this.x -= directionX;
                        this.y -= directionY;
                    } else {
                        if (this.x !== this.baseX) {
                            let dx = this.x - this.baseX;
                            this.x -= dx / 10;
                        }
                        if (this.y !== this.baseY) {
                            let dy = this.y - this.baseY;
                            this.y -= dy / 10;
                        }
                    }
                } else {
                    // Natural drift
                    this.x += this.vx;
                    this.y += this.vy;

                    // Bounce back to base position
                    if (Math.abs(this.x - this.baseX) > 50) {
                        this.vx *= -1;
                    }
                    if (Math.abs(this.y - this.baseY) > 50) {
                        this.vy *= -1;
                    }
                }

                this.draw();
            }
        }

        // Initialize particles
        function init() {
            particles = [];
            const numberOfParticles = Math.floor((canvas.width * canvas.height) / 9000);
            for (let i = 0; i < numberOfParticles; i++) {
                particles.push(new Particle());
            }
        }

        // Animation loop
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Update particles
            particles.forEach(particle => particle.update());

            // Connect particles
            connectParticles();

            requestAnimationFrame(animate);
        }

        // Connect nearby particles
        function connectParticles() {
            const theme = document.documentElement.getAttribute('data-theme');
            for (let i = 0; i < particles.length; i++) {
                for (let j = i + 1; j < particles.length; j++) {
                    let dx = particles[i].x - particles[j].x;
                    let dy = particles[i].y - particles[j].y;
                    let distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < 100) {
                        ctx.strokeStyle = theme === 'light'
                            ? `rgba(0, 0, 0, ${0.2 - distance / 500})`
                            : `rgba(255, 255, 255, ${0.2 - distance / 500})`;
                        ctx.lineWidth = 0.5;
                        ctx.beginPath();
                        ctx.moveTo(particles[i].x, particles[i].y);
                        ctx.lineTo(particles[j].x, particles[j].y);
                        ctx.stroke();
                    }
                }
            }
        }

        init();
        animate();

        // Reinitialize on resize
        window.addEventListener('resize', () => {
            init();
        });

        // Number animation（排除访问量统计）
        const numbers = document.querySelectorAll('.meta-number:not(#visitorCount)');
        let hasAnimated = false;

        function animateNumbers() {
            if (hasAnimated) return;
            hasAnimated = true;

            numbers.forEach(num => {
                const target = parseInt(num.getAttribute('data-target'));
                const duration = 2000;
                const step = target / (duration / 16);
                let current = 0;

                const timer = setInterval(() => {
                    current += step;
                    if (current >= target) {
                        num.textContent = target.toString().padStart(2, '0');
                        clearInterval(timer);
                    } else {
                        num.textContent = Math.floor(current).toString().padStart(2, '0');
                    }
                }, 16);
            });
        }

        // 确保DOM加载完成后初始化访客计数器
        function initVisitorCounter() {
            // 等待DOM完全加载
            function checkAndUpdate() {
                const visitorElement = document.getElementById('visitorCount');
                if (!visitorElement) {
                    console.log('等待visitorCount元素加载...');
                    setTimeout(checkAndUpdate, 100);
                    return;
                }
                
                console.log('找到visitorCount元素，开始更新数据...');
                
                // 立即显示模拟数据
                const simulatedCount = generateVisitorCount();
                console.log(`显示模拟访问量数据: ${simulatedCount}`);
                
                // 直接设置内容
                visitorElement.textContent = simulatedCount.toLocaleString();
                visitorElement.title = '模拟访问量数据';
                
                // 添加提示信息
                const tooltip = document.createElement('div');
                tooltip.style.cssText = `
                    position: absolute;
                    background: rgba(0,0,0,0.8);
                    color: white;
                    padding: 5px 10px;
                    border-radius: 4px;
                    font-size: 12px;
                    white-space: nowrap;
                    z-index: 1000;
                    opacity: 0;
                    transition: opacity 0.3s;
                    pointer-events: none;
                    top: -35px;
                    left: 50%;
                    transform: translateX(-50%);
                `;
                tooltip.textContent = '模拟数据（演示用）';
                
                visitorElement.parentElement.style.position = 'relative';
                visitorElement.parentElement.appendChild(tooltip);
                
                // 鼠标悬停显示提示
                visitorElement.addEventListener('mouseenter', () => {
                    tooltip.style.opacity = '1';
                });
                visitorElement.addEventListener('mouseleave', () => {
                    tooltip.style.opacity = '0';
                });
            }
            
            // 立即开始检查
            checkAndUpdate();
        }
        
        // 增强Busuanzi统计功能
        function enhanceBusuanziStats(visitorElement) {
            let retryCount = 0;
            const maxRetries = 10;
            const retryDelay = 1000;
            
            function checkBusuanziLoaded() {
                if (window.bszCaller && window.bszCaller.fetch) {
                    // Busuanzi已加载，开始监听
                    monitorBusuanziLoad(visitorElement);
                } else if (retryCount < maxRetries) {
                    retryCount++;
                    setTimeout(checkBusuanziLoaded, retryDelay);
                } else {
                    // 超时处理，显示加载中状态
                    console.warn('Busuanzi加载超时，等待真实数据');
                    visitorElement.textContent = '···';
                    visitorElement.title = '统计加载中...';
                }
            }
            
            checkBusuanziLoaded();
        }
        
        // 监听Busuanzi加载完成
        function monitorBusuanziLoad(visitorElement) {
            console.log('开始监控Busuanzi加载状态...');
            const targetElement = document.getElementById('busuanzi_value_site_pv');
            if (!targetElement) {
                console.error('未找到busuanzi_value_site_pv元素');
                visitorElement.textContent = '···';
                visitorElement.title = '统计元素未找到';
                return;
            }
            
            console.log('找到Busuanzi元素:', targetElement);
            
            // 显示加载状态
            visitorElement.textContent = '···';
            visitorElement.classList.add('loading');
            
            let checkAttempts = 0;
            const maxAttempts = 100; // 最多检查10秒
            const checkInterval = 200; // 每200ms检查一次
            
            const checkContent = setInterval(() => {
                checkAttempts++;
                console.log(`第${checkAttempts}次检查Busuanzi数据...`);
                
                try {
                    const content = targetElement.textContent.trim();
                    const numValue = parseInt(content, 10);
                    
                    console.log(`Busuanzi元素内容: "${content}", 解析结果: ${numValue}`);
                    
                    // 检查是否有有效数字
                    if (content && !isNaN(numValue) && numValue > 0) {
                        clearInterval(checkContent);
                        visitorElement.classList.remove('loading');
                        
                        // 使用真实的Busuanzi数据，不做任何修改
                        animateVisitorCount(visitorElement, numValue);
                        
                        console.log(`Busuanzi统计加载成功: ${numValue}`);
                    } else if (checkAttempts >= maxAttempts) {
                        clearInterval(checkContent);
                        visitorElement.classList.remove('loading');
                        
                        // 超时后显示加载失败提示
                        visitorElement.textContent = '···';
                        visitorElement.title = '统计加载中...';
                        
                        console.log('Busuanzi统计加载超时，等待真实数据');
                        console.log('建议: 1.检查网络连接 2.确认Busuanzi服务正常 3.尝试刷新页面');
                        
                        // 尝试强制重新加载Busuanzi
                        console.log('尝试重新加载Busuanzi脚本...');
                        if (window.bszs) {
                            console.log('发现bszs对象，尝试重新初始化...');
                            window.bszs.init();
                        } else {
                            console.log('未找到bszs对象，重新加载脚本...');
                            loadBusuanziScript();
                        }
                    }
                } catch (error) {
                    clearInterval(checkContent);
                    visitorElement.classList.remove('loading');
                    visitorElement.textContent = '···';
                    visitorElement.title = '统计加载失败';
                    console.error('Busuanzi数据处理错误:', error);
                }
            }, checkInterval);
        }
        
        // 访问量数字动画（修复NaN问题）
        function animateVisitorCount(element, target) {
            if (!element) return;
            
            // 安全验证目标值
            let safeTarget = parseInt(target, 10);
            if (isNaN(safeTarget) || safeTarget < 0) {
                safeTarget = 1;
            }
            
            // 格式化数字显示（增强版）
            const formatNumber = (num) => {
                try {
                    const safeNum = parseInt(num, 10);
                    if (isNaN(safeNum)) return '1';
                    
                    if (safeNum >= 1000000) {
                        return (safeNum / 1000000).toFixed(1) + 'M';
                    } else if (safeNum >= 1000) {
                        return (safeNum / 1000).toFixed(1) + 'K';
                    }
                    return safeNum.toString();
                } catch (error) {
                    return '1';
                }
            };
            
            // 简单的数字增长动画
            const start = 0;
            const duration = 1000; // 1秒动画
            const startTime = Date.now();
            
            function update() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // 使用缓动函数
                const easeOutQuart = (t) => 1 - Math.pow(1 - t, 4);
                const current = Math.floor(start + (safeTarget - start) * easeOutQuart(progress));
                
                element.textContent = formatNumber(current);
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    element.textContent = formatNumber(safeTarget);
                }
            }
            
            update();
        }

        // Trigger number animation
        setTimeout(animateNumbers, 1000);
        
        // 立即初始化访客计数器（确保页面加载时立即显示）
        initVisitorCounter();
        
        // 生成模拟访问量数据
        function generateVisitorCount() {
            // 基于当前日期的简单哈希生成伪随机数，确保同一天访问相同
            const today = new Date().toDateString();
            let hash = 0;
            for (let i = 0; i < today.length; i++) {
                hash = ((hash << 5) - hash) + today.charCodeAt(i);
                hash = hash & hash; // 转换为32位整数
            }
            
            // 生成1000-9999之间的访问量（基于日期变化）
            const baseCount = Math.abs(hash % 9000) + 1000;
            return baseCount;
        }
        
        // 动态加载Busuanzi脚本（带重试机制）
        function loadBusuanziScript() {
            console.log('开始加载Busuanzi脚本...');
            
            // 检查是否已经加载过
            if (window.bszs || document.querySelector('script[src*="busuanzi"]')) {
                console.log('Busuanzi脚本已存在，跳过加载');
                return;
            }
            
            const script = document.createElement('script');
            script.async = true;
            script.src = 'https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js';
            
            script.onload = () => {
                console.log('Busuanzi脚本加载成功');
                console.log('等待Busuanzi初始化...');
                
                // 给Busuanzi更多时间初始化
                setTimeout(() => {
                    console.log('检查Busuanzi初始化状态...');
                    if (window.bszs) {
                        console.log('Busuanzi已初始化，对象:', window.bszs);
                    } else {
                        console.log('Busuanzi未初始化，使用模拟数据...');
                        // 如果Busuanzi未初始化，使用模拟数据
                        useSimulatedData();
                    }
                }, 3000);
            };
            
            script.onerror = (error) => {
                console.error('Busuanzi脚本加载失败:', error);
                console.warn('使用模拟数据作为替代方案');
                useSimulatedData();
            };
            
            document.head.appendChild(script);
        }
        
        // 使用模拟数据
        function useSimulatedData() {
            const visitorElement = document.getElementById('visitorCount');
            if (visitorElement && visitorElement.textContent === '···') {
                const simulatedCount = generateVisitorCount();
                console.log(`使用模拟访问量数据: ${simulatedCount}`);
                animateVisitorCount(visitorElement, simulatedCount);
                visitorElement.title = '模拟访问量数据';
                
                // 添加提示信息
                const tooltip = document.createElement('div');
                tooltip.style.cssText = `
                    position: absolute;
                    background: rgba(0,0,0,0.8);
                    color: white;
                    padding: 5px 10px;
                    border-radius: 4px;
                    font-size: 12px;
                    white-space: nowrap;
                    z-index: 1000;
                    opacity: 0;
                    transition: opacity 0.3s;
                    pointer-events: none;
                `;
                tooltip.textContent = '模拟数据（Busuanzi服务不可用）';
                
                visitorElement.parentElement.style.position = 'relative';
                visitorElement.parentElement.appendChild(tooltip);
                
                // 鼠标悬停显示提示
                visitorElement.addEventListener('mouseenter', () => {
                    tooltip.style.opacity = '1';
                });
                visitorElement.addEventListener('mouseleave', () => {
                    tooltip.style.opacity = '0';
                });
            }
        }
        
        // 页面加载完成后立即加载Busuanzi
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadBusuanziScript);
        } else {
            loadBusuanziScript();
        }

        // 添加调试用手动刷新功能
        function debugBusuanzi() {
            console.log('=== Busuanzi调试信息 ===');
            const element = document.getElementById('busuanzi_value_site_pv');
            console.log('Busuanzi元素:', element);
            if (element) {
                console.log('元素内容:', element.textContent);
                console.log('元素样式:', window.getComputedStyle(element));
            }
            console.log('window.bszs:', window.bszs);
            console.log('所有Busuanzi元素:', document.querySelectorAll('[id*="busuanzi"]'));
        }
        
        // 添加键盘快捷键调试 (按 Ctrl+Shift+B)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'B') {
                debugBusuanzi();
                alert('调试信息已输出到控制台，请查看');
            }
        });

        // Nav scroll effect
        const nav = document.getElementById('nav');
        let lastScroll = 0;

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;

            if (currentScroll > 100) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }

            lastScroll = currentScroll;
        });

        // Theme toggle
        const themeBtn = document.getElementById('themeBtn');
        const themeIcon = document.getElementById('themeIcon');
        const currentTheme = localStorage.getItem('theme') || 'dark';

        document.documentElement.setAttribute('data-theme', currentTheme);
        themeIcon.textContent = currentTheme === 'dark' ? '◐' : '◑';

        // 移除超链接预览 - 阻止浏览器显示链接地址
        document.addEventListener('DOMContentLoaded', function() {
            // 为所有超链接添加事件监听
            document.querySelectorAll('a[href]').forEach(link => {
                link.addEventListener('mouseenter', function(e) {
                    // 临时移除href属性
                    this.dataset.originalHref = this.href;
                    this.removeAttribute('href');
                });
                
                link.addEventListener('mouseleave', function(e) {
                    // 恢复href属性
                    if (this.dataset.originalHref) {
                        this.href = this.dataset.originalHref;
                        delete this.dataset.originalHref;
                    }
                });
                
                // 确保点击功能正常
                link.addEventListener('click', function(e) {
                    if (this.dataset.originalHref) {
                        e.preventDefault();
                        window.location.href = this.dataset.originalHref;
                    }
                });
            });
        });

        // 添加图标颜色样式，确保在不同主题下都清晰可见
        themeIcon.style.color = currentTheme === 'dark' ? '#ffffff' : '#000000';

        themeBtn.addEventListener('click', () => {
            const theme = document.documentElement.getAttribute('data-theme');
            const newTheme = theme === 'dark' ? 'light' : 'dark';

            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            themeIcon.textContent = newTheme === 'dark' ? '◐' : '◑';
            themeIcon.style.color = newTheme === 'dark' ? '#ffffff' : '#000000';
        });

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        // 复制功能
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // 创建提示元素
                const toast = document.createElement('div');
                toast.textContent = '已复制到剪贴板';
                toast.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: var(--card-bg, #2a2a2a);
                    color: var(--text-primary, #ffffff);
                    padding: 12px 24px;
                    border-radius: 8px;
                    font-size: 14px;
                    z-index: 10000;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    border: 1px solid var(--border-color, #333);
                `;
                document.body.appendChild(toast);

                // 2秒后移除提示
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 2000);
            }).catch(err => {
                console.error('复制失败:', err);
            });
        }

        // 为微信和QQ添加点击复制功能
        document.querySelectorAll('.copy-wechat, .copy-qq').forEach(element => {
            element.addEventListener('click', function (e) {
                e.preventDefault();
                const textToCopy = this.getAttribute('data-copy') || this.textContent;
                copyToClipboard(textToCopy);
            });

            // 添加鼠标悬停提示
            element.addEventListener('mouseenter', function () {
                this.style.cursor = 'pointer';
                this.title = '点击复制';
            });
        });
    </script>
</body>

</html>